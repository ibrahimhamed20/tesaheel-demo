import{a as Fi,b as Ce}from"./chunk-W42J3D5O.js";import{a as Di,b as we}from"./chunk-TJQN6HPD.js";import{a as ge,b as se}from"./chunk-JOMO22QM.js";import{a as xe,b as Be,c as ne,e as Ti,i as re,k as z,l as Ye,m as oe}from"./chunk-2XAT2JOF.js";import{c as Le,d as k,f as _e}from"./chunk-FFRWIXDO.js";import{m as te,n as O,q as Ai,r as Ni}from"./chunk-ZIFIHYY2.js";import{b as Q,c as E,e as W,f as Y,g as pe,i as Ve,k as Z,l as Qe,m as We,n as J,r as K,s as he,t as ee,w as ae,x as j}from"./chunk-HPGERUHF.js";import{f as ie,g as H}from"./chunk-VNHB2M7P.js";import{a as F}from"./chunk-QEQCDFPQ.js";import{b as P,c as R,d as x}from"./chunk-TI22M3TN.js";import{i as Si,n as X}from"./chunk-CVH3MUVM.js";import{$a as g,Ac as Fe,Cc as Xe,Dc as fe,Eb as m,Fb as b,Gb as h,Gc as ye,Ia as Te,Ib as Oe,J as Ne,Jb as je,K as v,Kb as $e,Lb as Ii,Lc as V,Ma as n,Mb as L,Na as f,Nb as D,O as de,Ob as I,T as me,Xb as o,Y as y,Yb as c,Zb as C,bb as p,eb as ke,f as G,ga as B,ha as w,hb as M,j as be,lb as s,mb as r,n as Ie,na as ue,nb as S,ob as ri,pb as oi,rb as U,tb as _,ub as A,v as Se,y as Ae,yb as De}from"./chunk-FUWWX4DR.js";import{a as N,b as T}from"./chunk-4CLCTAJ7.js";var Ze=(()=>{class t{_http;constructor(e){this._http=e}deleteClassification(e){return this._http.delete(`${F.URL_API}Classifications/${e}`)}addClassification(e){return this._http.post(`${F.URL_API}Classifications`,e)}editClassification(e){return this._http.put(`${F.URL_API}Classifications`,e)}getAllClassifications(e){return this._http.get(`${F.URL_API}Classifications?PageSize=${e.size}&PageNumber=${e.number}`)}getClassificationById(e){return this._http.get(`${F.URL_API}Classifications/${e}`)}uploadGalaryImage(e){let a=new FormData;return a.append("file",e),this._http.post(`${F.URL_API}BlobsStore/file`,a)}getAllMerchantClassification(){return this._http.get(`${F.URL_API}Merchants/Classifications`)}static \u0275fac=function(a){return new(a||t)(me(_e))};static \u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Li={columns:[{field:"id",header:"ID",type:"label",exported:!1},{field:"name",header:"CLASSIFICATION",type:"label",exported:!1},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",locale:"FIELDS.",actions:["CREATE"],rowsActions:["EDIT","DELETE"],dataLoading:"client",paginator:!0,globalFilterFields:["name"]};var li=function(t){return t[t.NoService=0]="NoService",t[t.Maintenance=1]="Maintenance",t[t.Pets=2]="Pets",t}(li||{});var pi=t=>({"ng-dirty ng-invalid":t}),ci=t=>({fieldName:t}),xi=()=>({maxLength:50});function Xi(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,ci,c(2,1,"FIELDS.SERVICE_TYPE")))," "))}function Qi(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,ci,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function Wi(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,xi))," "))}function Yi(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,ci,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function Zi(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,xi))," "))}function Ji(t,u){if(t&1){let e=U();s(0,"div",11),S(1,"img",15),s(2,"img",16),_("click",function(){B(e);let i=A();return w(i.removeFile())}),r()()}if(t&2){let e=A();n(),p("src",e.classification.icon==null?null:e.classification.icon.blobUrI,Te)("alt",e.classification.icon==null?null:e.classification.icon.id)}}function Ki(t,u){if(t&1){let e=U();s(0,"label",17),m(1,"Classification Icon"),r(),s(2,"p-fileUpload",18),_("onSelect",function(i){B(e);let l=A();return w(l.uploadFile(i))}),r()}t&2&&(n(2),p("showUploadButton",!1)("showCancelButton",!1)("maxFileSize",1e6))}var di=(()=>{class t{_classifications;_popup;_translate;_toastr;_fb;destroy$=new G;formError;classificationsForm;classification;serviceTypes;constructor(e,a,i,l,d){this._classifications=e,this._popup=a,this._translate=i,this._toastr=l,this._fb=d}ngOnInit(){this.classification=this._popup.getData(),this.serviceTypes=Fi.getEnumOptions(li),this.classificationsForm=this.initForm(),this.formError=new Le.ErrorManagement(this.classificationsForm),this.classification.id&&this.getClassificationDetails()}getClassificationDetails(){this._classifications.getClassificationById(this.classification.id).pipe(v(this.destroy$)).subscribe(e=>{this.classification=e.data,this.classification.id&&this.patchFormData()})}initForm(){return this._fb.group({id:[0],arabicName:["",[E.required]],englishName:["",[E.required]],serviceType:[null,[E.required]],icon:this._fb.group({id:0,externalStorageId:"",mimeType:"",has360View:!1,sizeInBytes:0,blobUrI:""})})}patchFormData(){this.classificationsForm.patchValue({id:this.classification.id,arabicName:this.classification.arabicName,englishName:this.classification.englishName,serviceType:this.classification.serviceType,icon:this.classification.icon});let e=this.classificationsForm.get("icon");this.classification.icon&&e.patchValue({id:this.classification.icon.id,externalStorageId:this.classification.icon.externalStorageId,mimeType:this.classification.icon.mimeType,has360View:this.classification.icon.has360View,sizeInBytes:this.classification.icon.sizeInBytes,blobUrI:this.classification.icon.blobUrI})}uploadFile(e){let a=e.files;if(a.length>0){let i=a[0];this.classificationsForm.get("icon").patchValue({id:0,externalStorageId:i.name,mimeType:i.type,sizeInBytes:i.size,has360View:!0,blobUrl:URL.createObjectURL(i)})}}removeFile(){this.classificationsForm.get("icon")?.get("blobUrI")?.setValue(""),this.classification.icon&&(this.classification.icon.blobUrI=void 0)}save(){let e=this.classificationsForm.getRawValue();(e.id?this._classifications.editClassification(e):this._classifications.addClassification(e)).pipe(v(this.destroy$)).subscribe(()=>this.afterSavingDone(e.id?"edit":"add",e))}afterSavingDone(e,a){let i=this._translate.currentLang==="ar"?a?.arabicName:a?.englishName;this._translate.get(e?"GENERAL.ADDED_SUCCESSFULLY":"UPDATED_SUCCESSFULLY",{name:i}).subscribe(l=>this._toastr.success(l)),this._popup.close(!0)}close=()=>this._popup.close();static \u0275fac=function(a){return new(a||t)(f(Ze),f(z),f(P),f(k),f(K))};static \u0275cmp=y({type:t,selectors:[["admin-classification-form"]],standalone:!0,features:[L],decls:34,vars:46,consts:[["autocomplete","off",3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],["for","serviceType"],["formControlName","serviceType","optionLabel","label","optionValue","value","filterBy","label",1,"w-full",3,"options","ngClass","filter","showClear","placeholder"],["id","serviceType-error",1,"text-error"],[1,"field","col-12","md:col-6"],["for","englishName"],["pInputText","","type","text","pInputText","","formControlName","englishName",1,"w-full",3,"ngClass","placeholder"],["for","arabicName"],["type","text","pInputText","","formControlName","arabicName",1,"w-full",3,"ngClass","placeholder"],[1,"container-img"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","disabled","label"],[3,"src","alt"],["src","assets/layout/images/close-icon.svg","alt","close-icon",1,"close",3,"click"],["for","icon"],["name","icon","id","icon","accept","image/*",3,"onSelect","showUploadButton","showCancelButton","maxFileSize"]],template:function(a,i){a&1&&(s(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),m(4),o(5,"translate"),r(),S(6,"p-dropdown",4),o(7,"translate"),g(8,Xi,4,8,"small",5),r(),s(9,"div",6)(10,"label",7),m(11),o(12,"translate"),r(),S(13,"input",8),o(14,"translate"),g(15,Qi,4,8,"small",5)(16,Wi,3,5,"small",5),r(),s(17,"div",6)(18,"label",9),m(19),o(20,"translate"),r(),S(21,"input",10),o(22,"translate"),g(23,Yi,4,8,"small",5)(24,Zi,3,5,"small",5),r(),s(25,"div",2),g(26,Ji,3,2,"div",11)(27,Ki,3,3),r()()(),s(28,"div",12)(29,"p-button",13),o(30,"translate"),_("onClick",function(){return i.close()}),r(),s(31,"p-button",14),o(32,"translate"),o(33,"translate"),_("onClick",function(){return i.save()}),r()()),a&2&&(p("formGroup",i.classificationsForm),n(4),b(c(5,22,"FIELDS.SERVICE_TYPE")),n(2),p("options",i.serviceTypes)("ngClass",I(40,pi,i.formError.hasError("serviceType")))("filter",!0)("showClear",!0)("placeholder",c(7,24,"FIELDS.SERVICE_TYPE")),n(2),M(i.formError.hasSpecificError("serviceType","required")?8:-1),n(3),b(c(12,26,"FIELDS.ENGLISH_NAME")),n(2),p("ngClass",I(42,pi,i.formError.hasError("englishName")))("placeholder",c(14,28,"FIELDS.ENGLISH_NAME")),n(2),M(i.formError.hasSpecificError("englishName","required")?15:-1),n(),M(i.formError.hasSpecificError("englishName","maxlength")?16:-1),n(3),b(c(20,30,"FIELDS.ARABIC_NAME")),n(2),p("ngClass",I(44,pi,i.formError.hasError("arabicName")))("placeholder",c(22,32,"FIELDS.ARABIC_NAME")),n(2),M(i.formError.hasSpecificError("arabicName","required")?23:-1),n(),M(i.formError.hasSpecificError("arabicName","maxlength")?24:-1),n(2),M(i.classification.icon!=null&&i.classification.icon.blobUrI?26:27),n(3),p("label",c(30,34,"GENERAL.CANCEL")),n(2),p("disabled",i.classificationsForm.invalid)("label",i.classification.id?c(32,36,"GENERAL.UPDATE"):c(33,38,"GENERAL.SAVE")))},dependencies:[V,Fe,ee,Ve,Q,W,Y,Z,J,O,te,j,ae,Be,xe,ie,H,x,R],styles:[".container-img[_ngcontent-%COMP%]{width:160px;height:124px;border:2px solid #ff7f3e;border-radius:8px;overflow:hidden;position:relative}.container-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.container-img[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:4px;inset-inline-end:4px;cursor:pointer;height:20px;width:20px;background:#ff7f3e;padding:5px;border-radius:50%}"]})}return t})();var qa=(()=>{class t{_classifications;_confirm;_translate;_popup;_toast;destroy$=new G;tableConfig$;filters={number:1,size:10};constructor(e,a,i,l,d){this._classifications=e,this._confirm=a,this._translate=i,this._popup=l,this._toast=d}ngOnInit(){this.getAllClassifications(this.filters)}onActionClicked(e){switch(e.action){case"CREATE":this.createClassification();break;case"EDIT":this.editClassification(e.data);break;case"DELETE":this.deleteClassification(e.data);break}}getAllClassifications(e){this.tableConfig$=this._classifications.getAllClassifications(e).pipe(Ie(a=>T(N({},Li),{rows:a.data?.classifications,totalRecords:a.data.rowCount})))}createClassification(){this._popup.open(di,{title:this._translate.instant("CLASSIFICATIONS.ADD_NEW_CLASSIFICATION"),position:this._translate.currentLang==="ar"?"left":"right"}).afterClosed.subscribe(e=>e&&this.getAllClassifications(this.filters))}editClassification(e){this._popup.open(di,{title:this._translate.instant("CLASSIFICATIONS.EDIT_CLASSIFICATION"),position:this._translate.currentLang==="ar"?"left":"right",data:e}).afterClosed.subscribe(a=>a&&this.getAllClassifications(this.filters))}deleteClassification(e){e.id&&this._confirm.confirm("delete").subscribe(a=>{a&&this._classifications.deleteClassification(e.id).pipe(v(this.destroy$)).subscribe(()=>{this._toast.success(this._translate.instant("CLASSIFICATIONS.DELETE_CLASSIFICATION_SUCCESS")),this.getAllClassifications(this.filters)})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(f(Ze),f(re),f(P),f(z),f(k))};static \u0275cmp=y({type:t,selectors:[["admin-classifications"]],standalone:!0,features:[L],decls:2,vars:3,consts:[[3,"actionClicked","config"]],template:function(a,i){a&1&&(s(0,"shared-ui-table",0),o(1,"async"),_("actionClicked",function(d){return i.onActionClicked(d)}),r()),a&2&&p("config",c(1,1,i.tableConfig$))},dependencies:[V,ye,ne,oe,x],encapsulation:2})}return t})();var Je=t=>({fieldName:t}),fi=()=>({maxLength:50});function et(t,u){t&1&&(s(0,"div",17),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,Je,c(2,1,"FIELDS.CLASSIFICATION")))," "))}function it(t,u){t&1&&(s(0,"div",17),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,Je,c(2,1,"FIELDS.BAR_CODE_NO")))," "))}function tt(t,u){t&1&&(s(0,"div",17),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,fi))," "))}function at(t,u){t&1&&(s(0,"div",17),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,Je,c(2,1,"FIELDS.SHORT_ARABIC_NAME")))," "))}function nt(t,u){t&1&&(s(0,"div",17),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,fi))," "))}function rt(t,u){t&1&&(s(0,"div",17),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,Je,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function ot(t,u){t&1&&(s(0,"div",17),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,fi))," "))}function st(t,u){if(t&1){let e=U();ri(0),s(1,"p-fileUpload",18),o(2,"translate"),_("onSelect",function(i){B(e);let l=A();return w(l.onFileSelect(i))}),r(),oi()}t&2&&(n(),p("chooseLabel",c(2,1,"GENERAL.CHOOSE")))}function lt(t,u){if(t&1){let e=U();ri(0),s(1,"div",19),S(2,"img",20),s(3,"img",21),_("click",function(){B(e);let i=A();return w(i.removeImage())}),r()(),oi()}if(t&2){let e=A();n(2),p("src",e.data==null||e.data.response==null||e.data.response.icon==null?null:e.data.response.icon.blobUrI,Te)("alt",e.data==null||e.data.response==null||e.data.response.icon==null?null:e.data.response.icon.id)}}var _i=(()=>{class t{_fb;_popup;_translate;_toastr;_product;destroy$=new G;classifications=[];data;dialogForm;constructor(e,a,i,l,d){this._fb=e,this._popup=a,this._translate=i,this._toastr=l,this._product=d}ngOnInit(){this.prepareForm(),this.data=this._popup.getData(),this.classifications=this.data?.classifications,console.log("data?.response",this.data?.response),this.data?.response&&(this.dialogForm.patchValue(this.data?.response),this.setPreSelectedValues())}prepareForm(){this.dialogForm=this._fb.group({arabicName:[null,[E.required,E.maxLength(50)]],englishName:[null,[E.required,E.maxLength(50)]],classificationsIds:[null],classifications:[null,E.required],barcodeNumber:[null,E.required],icon:this._fb.group({externalStorageId:"",mimeType:"",sizeInBytes:0,blobUrI:""})})}get control(){return this.dialogForm.controls}onClassificationChange(e){let a=e.value.map(i=>i.id);this.dialogForm.get("classificationsIds")?.setValue(a),this.dialogForm.get("classifications")?.setValue(e.value)}setPreSelectedValues(){let e=this.data?.classifications.map(i=>this.classifications.find(l=>l.id===i.id)),a=e?.map(i=>i?.id);this.dialogForm.get("classificationsIds")?.setValue(a),this.dialogForm.patchValue({classifications:e})}save(){let e=this.dialogForm.getRawValue();(this.data?.response?this._product.editCategory(e):this._product.addCategory(e)).pipe(v(this.destroy$)).subscribe(()=>this.afterSavingDone(this.data?.response?"edit":"add",e))}afterSavingDone(e,a){let i=this._translate.currentLang==="ar"?a?.arabicName:a?.englishName;this._translate.get(e=="add"?"GENERAL.ADDED_SUCCESSFULLY":"GENERAL.UPDATED_SUCCESSFULLY",{name:i}).subscribe(l=>this._toastr.success(l)),this._popup.close(!0)}removeImage(){this.data&&this.data.icon&&(this.data.icon.blobUrI=void 0)}onFileSelect(e){if(e.files&&e.files[0]){let a=e.files[0];this.uploadImage(a).subscribe(i=>{this.updateFormWithResponse(i.data)},i=>{console.error("Error during image upload:",i)})}}uploadImage(e){let a=new FormData;return a.append("file",e),this._product.uploadGalaryImage(a)}updateFormWithResponse(e){this.dialogForm.get("icon")?.setValue({externalStorageId:e.externalStorageId,mimeType:e.mimeType,sizeInBytes:e.sizeInBytes,blobUrI:e.blobUrI})}close=()=>this._popup.close();static \u0275fac=function(a){return new(a||t)(f(K),f(z),f(P),f(k),f(Ce))};static \u0275cmp=y({type:t,selectors:[["admin-add-edit-category"]],standalone:!0,features:[Ii([Si]),L],decls:43,vars:45,consts:[[1,"form-content",3,"formGroup"],[1,"row"],[1,"col-6"],["for","classification",1,"mb-2","block"],["formControlName","classifications","optionLabel","name",3,"onChange","options","placeholder"],["class","error-message",4,"ngIf"],["for","barcodeNumber",1,"mb-2","block"],["mode","decimal","inputId","withoutgrouping","formControlName","barcodeNumber",1,"w-full",3,"useGrouping","placeholder"],["for","arabicName",1,"mb-2","block"],["type","text","pInputText","","formControlName","arabicName",1,"w-full",3,"placeholder"],["for","englishName",1,"mb-2","block"],["type","text","pInputText","","formControlName","englishName",1,"w-full",3,"placeholder"],[1,"col-12"],[4,"ngIf"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","label","disabled"],[1,"error-message"],["mode","basic","chooseIcon","pi pi-upload","name","demo[]","accept","image/*","maxFileSize","1000000",3,"onSelect","chooseLabel"],[1,"container-img"],[3,"src","alt"],["src","assets/layout/images/close-icon.svg","alt","close-icon",1,"close",3,"click"]],template:function(a,i){a&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),m(4),o(5,"translate"),r(),s(6,"p-multiSelect",4),o(7,"translate"),_("onChange",function(d){return i.onClassificationChange(d)}),r(),g(8,et,4,8,"div",5),r(),s(9,"div",2)(10,"label",6),m(11),o(12,"translate"),r(),S(13,"p-inputNumber",7),o(14,"translate"),g(15,it,4,8,"div",5)(16,tt,3,5,"div",5),r(),s(17,"div",2)(18,"label",8),m(19),o(20,"translate"),r(),S(21,"input",9),o(22,"translate"),g(23,at,4,8,"div",5)(24,nt,3,5,"div",5),r(),s(25,"div",2)(26,"label",10),m(27),o(28,"translate"),r(),S(29,"input",11),o(30,"translate"),g(31,rt,4,8,"div",5)(32,ot,3,5,"div",5),r(),s(33,"div",12),g(34,st,3,3,"ng-container",13)(35,lt,4,2,"ng-container",13),r(),s(36,"div",12)(37,"div",14)(38,"p-button",15),o(39,"translate"),_("onClick",function(){return i.close()}),r(),s(40,"p-button",16),o(41,"translate"),o(42,"translate"),_("onClick",function(){return i.save()}),r()()()()()),a&2&&(p("formGroup",i.dialogForm),n(4),b(c(5,23,"FIELDS.CLASSIFICATION")),n(2),p("options",i.classifications)("placeholder",c(7,25,"FIELDS.CLASSIFICATION")),n(2),p("ngIf",i.control.classifications.touched&&(i.control.classifications.errors==null?null:i.control.classifications.errors.required)),n(3),b(c(12,27,"FIELDS.BAR_CODE_NO")),n(2),p("useGrouping",!1)("placeholder",c(14,29,"FIELDS.BAR_CODE_NO")),n(2),p("ngIf",i.control.barcodeNumber.touched&&(i.control.barcodeNumber.errors==null?null:i.control.barcodeNumber.errors.required)),n(),p("ngIf",i.control.barcodeNumber.touched&&(i.control.barcodeNumber.errors==null?null:i.control.barcodeNumber.errors.maxlength)),n(3),b(c(20,31,"FIELDS.SHORT_ARABIC_NAME")),n(2),p("placeholder",c(22,33,"FIELDS.SHORT_ARABIC_NAME")),n(2),p("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.required)),n(),p("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.maxlength)),n(3),b(c(28,35,"FIELDS.ENGLISH_NAME")),n(2),p("placeholder",c(30,37,"FIELDS.ENGLISH_NAME")),n(2),p("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.required)),n(),p("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.maxlength)),n(2),p("ngIf",!(!(i.data==null||i.data.response==null||i.data.response.icon==null)&&i.data.response.icon.blobUrI)),n(),p("ngIf",i.data==null||i.data.response==null||i.data.response.icon==null?null:i.data.response.icon.blobUrI),n(3),p("label",c(39,39,"GENERAL.CANCEL")),n(2),p("label",i.data!=null&&i.data.response?c(41,41,"GENERAL.UPDATE"):c(42,43,"GENERAL.SAVE"))("disabled",i.dialogForm.invalid))},dependencies:[V,fe,he,Q,W,Y,Be,xe,ie,se,ge,x,R,we,Ni,Ai,ee,Z,J,j,ae,H],styles:[".container-img[_ngcontent-%COMP%]{width:160px;height:124px;border:2px solid #ff7f3e;border-radius:8px;overflow:hidden;position:relative}.container-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.container-img[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:4px;inset-inline-end:4px;cursor:pointer;height:20px;width:20px;background:#ff7f3e;padding:5px;border-radius:50%}"]})}return t})();var Ke={columns:[{field:"name",header:"CATEGORY_NAME",type:"label",exported:!1},{field:"subCategories",header:"SUB_CATAGORY",type:"label",exported:!0},{field:"classification",header:"CLASSIFICATION",type:"label",exported:!0},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",actions:["CREATE"],rowsActions:["EDIT","DELETE"],paginator:!0,locale:"FIELDS.",dataLoading:"server"};function pt(t,u){if(t&1&&(s(0,"div",7)(1,"div"),m(2),r()()),t&2){let e=u.$implicit;n(2),b(e.name)}}var Vn=(()=>{class t{_confirm;_product;_popup;_translate;_unsubscribeAll=new G;classifications=[];tableConfig;displayDialog=!1;selectedClassification=null;pageSize=10;pageNumber=1;totalRecords=0;first=0;keyword="";searchControl=new pe;constructor(e,a,i,l){this._confirm=e,this._product=a,this._popup=i,this._translate=l}ngOnInit(){this.tableConfig=Ke,this.getAllCategories(),this.getClassifications(),this.onSearch()}getClassifications(){this._product.getClassifications().pipe(v(this._unsubscribeAll)).subscribe(e=>{this.classifications=e?.data?.classifications})}onActionClicked(e){switch(e.action){case"CREATE":this.openCreateDialog();break;case"EDIT":this.getCategoryById(e.data);break;case"DELETE":this.onActionDelete(e.data);break}}onActionDelete(e){this._confirm.confirm("delete").subscribe(a=>{a&&this._product.deleteCategory(e.id).pipe(v(this._unsubscribeAll)).subscribe(i=>{i.data&&this.getAllCategories()})})}onClassificationChange(e){this.selectedClassification=e.value,this.filterCategories()}getAllCategories(){this._product.getAllCategories(this.pageSize,this.pageNumber,this.keyword).pipe(v(this._unsubscribeAll)).subscribe(e=>{this.tableConfig=T(N({},Ke),{rows:e.data.result.map(a=>T(N({},a),{classification:a?.classification.map(i=>i.name).join(", "),subCategories:a?.subCategories.map(i=>i.name).join(", ")}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT","DELETE"]})})}filterCategories(){this.selectedClassification?this._product.getAllCategories(this.pageSize,this.pageNumber,this.keyword).pipe(v(this._unsubscribeAll)).subscribe(e=>{let a=e.data.result.filter(i=>Array.isArray(i.classification)?i.classification.some(l=>l.id===this.selectedClassification?.id):i.classification?.id===this.selectedClassification?.id);this.tableConfig.rows=a.map(i=>T(N({},i),{classification:Array.isArray(i.classification)?i.classification.map(l=>l.name).join(", "):i.classification?.name,subCategories:i.subCategories.map(l=>l.name).join(", ")}))}):this.getAllCategories()}onPageChange(e){this.first=e.first||0,this.pageSize=e.rows||10,this.pageNumber=e.page||1,this.getAllCategories()}onDialogClose(){this.displayDialog=!1}onSearch(){this.searchControl.valueChanges.pipe(Se(e=>e.trim().length>=0),Ae(400),Ne(e=>this._product.getAllCategories(this.pageSize,this.pageNumber,e.trim()))).subscribe(e=>{e&&e.data&&(this.tableConfig=T(N({},Ke),{rows:e.data.result.map(a=>T(N({},a),{classification:a.classification.map(i=>i.name).join(", "),subCategories:a.subCategories.map(i=>i.name).join(", ")}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT","DELETE"]}))})}openCreateDialog(){this._popup.open(_i,{title:this._translate.instant("CATEGORY.ADD_NEW_CATEGORY"),position:this._translate.currentLang==="ar"?"left":"right",data:{classifications:this.classifications}}).afterClosed.subscribe(e=>e&&this.getAllCategories())}getCategoryById(e){this._product.getCategoryById(Number(e.id)).subscribe(a=>{a.data&&this._popup.open(_i,{title:this._translate.instant("CATEGORY.EDIT_NEW_CATEGORY"),position:this._translate.currentLang==="ar"?"left":"right",data:{response:a.data,classifications:this.classifications}}).afterClosed.subscribe(i=>i&&this.getAllCategories())})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static \u0275fac=function(a){return new(a||t)(f(re),f(Ce),f(z),f(P))};static \u0275cmp=y({type:t,selectors:[["admin-categories"]],standalone:!0,features:[L],decls:10,vars:7,consts:[[1,"dialog-side"],[3,"actionClicked","onPage","onSearch","config"],["filters-area","",1,"filters","row"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["formControlName","classification","optionLabel","name","filterBy","name",1,"w-full",3,"onChange","options","filter","showClear","placeholder"],["pTemplate","selectedItem"],[1,"flex","align-items-center","gap-2"]],template:function(a,i){a&1&&(s(0,"section",0)(1,"shared-ui-table",1),_("actionClicked",function(d){return i.onActionClicked(d)})("onPage",function(d){return i.onPageChange(d)})("onSearch",function(d){return i.searchControl.patchValue(d)}),s(2,"div",2)(3,"div",3),m(4,"Filters"),r(),s(5,"div",4),m(6,"` "),s(7,"p-dropdown",5),o(8,"translate"),_("onChange",function(d){return i.onClassificationChange(d)}),g(9,pt,3,1,"ng-template",6),r()()()()()),a&2&&(n(),p("config",i.tableConfig),n(6),p("options",i.classifications)("filter",!0)("showClear",!0)("placeholder",c(8,5,"FIELDS.CLASSIFICATION")))},dependencies:[V,ne,O,te,X,oe,x,R],encapsulation:2})}return t})();var ze=t=>({fieldName:t}),ei=()=>({maxLength:50});function ct(t,u){if(t&1&&m(0),t&2){let e=u.$implicit;h(" ",e.name," ")}}function dt(t,u){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,ze,c(2,1,"FIELDS.CLASSIFICATION")))," "))}function mt(t,u){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,ze,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function ut(t,u){t&1&&(s(0,"div",18),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ei))," "))}function ft(t,u){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,ze,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function _t(t,u){t&1&&(s(0,"div",18),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ei))," "))}function ht(t,u){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,ze,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function gt(t,u){t&1&&(s(0,"div",18),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ei))," "))}function Ct(t,u){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,ze,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function Et(t,u){t&1&&(s(0,"div",18),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ei))," "))}function vt(t,u){if(t&1){let e=U();s(0,"div",19)(1,"div",6)(2,"div",20)(3,"div",21)(4,"div",8)(5,"label",9),m(6),o(7,"translate"),r(),S(8,"input",22),o(9,"translate"),g(10,ht,4,8,"div",5)(11,gt,3,5,"div",5),r()(),s(12,"div",23)(13,"div",8)(14,"label",9),m(15),o(16,"translate"),r(),S(17,"input",24),o(18,"translate"),g(19,Ct,4,8,"div",5)(20,Et,3,5,"div",5),r()(),s(21,"div",25)(22,"div",15)(23,"p-button",26),_("click",function(){B(e);let i=A();return w(i.addNewVariants())}),r(),s(24,"p-button",27),_("click",function(){let i=B(e).index,l=A();return w(l.removeVariants(i))}),r()()()()()()}if(t&2){let e,a,i,l,d=u.index,$=A();p("formGroupName",d),n(6),b(c(7,13,"FIELDS.ARABIC_NAME")),n(2),De("id","arabicName",d,""),p("placeholder",c(9,15,"FIELDS.ARABIC_NAME")),n(2),p("ngIf",((e=$.variantValues.at(d).get("arabicName"))==null?null:e.touched)&&((e=$.variantValues.at(d).get("arabicName"))==null?null:e.hasError("required"))),n(),p("ngIf",((a=$.variantValues.at(d).get("arabicName"))==null?null:a.touched)&&((a=$.variantValues.at(d).get("arabicName"))==null?null:a.hasError("maxlength"))),n(4),b(c(16,17,"FIELDS.ENGLISH_NAME")),n(2),De("id","englishName",d,""),p("placeholder",c(18,19,"FIELDS.ENGLISH_NAME")),n(2),p("ngIf",((i=$.variantValues.at(d).get("englishName"))==null?null:i.touched)&&((i=$.variantValues.at(d).get("englishName"))==null?null:i.hasError("required"))),n(),p("ngIf",((l=$.variantValues.at(d).get("englishName"))==null?null:l.touched)&&((l=$.variantValues.at(d).get("englishName"))==null?null:l.hasError("maxlength")))}}var Bi=(()=>{class t{fb;save=new ue;closeVariantValue=new ue;addVariantForm;classifications=[];breadcrumb;variantsData;constructor(e){this.fb=e}ngOnInit(){this.initForm(),this.setdataInform()}initForm(){this.addVariantForm=this.fb.group({id:[0],arabicName:["",[E.required,E.maxLength(50)]],englishName:["",[E.required,E.maxLength(50)]],classificationIds:[[],E.required],variantValues:this.fb.array([this.createVariantGroup()])})}setdataInform(){if(this.variantsData){this.addVariantForm.patchValue(this.variantsData);let e=this.getSelectedOptions(this.variantsData.classificationIds);this.addVariantForm.patchValue({classificationIds:e}),this.variantValues.clear();for(let a=0;a<this.variantsData.variantValues.length;a++)this.variantValues.push(this.fb.group({id:this.variantsData.variantValues[a].id,englishName:this.variantsData.variantValues[a].englishName,arabicName:this.variantsData.variantValues[a].arabicName}))}}getSelectedOptions(e){return this.classifications.filter(a=>e.includes(a.id))}get variantValues(){return this.addVariantForm.get("variantValues")}get control(){return this.addVariantForm.controls}createVariantGroup(){return this.fb.group({id:[0],arabicName:["",[E.required,E.maxLength(50)]],englishName:["",[E.required,E.maxLength(50)]]})}addNewVariants(){this.variantValues.push(this.createVariantGroup())}removeVariants(e){e&&this.variantValues.removeAt(e)}onSave(){this.addVariantForm.valid?this.save.emit(this.addVariantForm.value):this.addVariantForm.markAllAsTouched()}onClose(){this.closeVariantValue.emit()}static \u0275fac=function(a){return new(a||t)(f(K))};static \u0275cmp=y({type:t,selectors:[["admin-add-edit-variants"]],inputs:{classifications:"classifications",variantsData:"variantsData"},outputs:{save:"save",closeVariantValue:"closeVariantValue"},standalone:!0,features:[L],decls:34,vars:33,consts:[[1,"p-fluid","formgrid",3,"formGroup"],[1,"p-grid","mb-1"],[1,"p-col-6"],["optionLabel","name","formControlName","classificationIds",3,"options","filter","placeholder"],["pTemplate","item"],["class","error-message",4,"ngIf"],[1,"grid"],[1,"field","col-6"],[1,"flex","flex-column","gap-2"],["for","arabicName"],["pInputText","","formControlName","arabicName","id","arabicName","aria-describedby","arabicName-help",3,"placeholder"],["for","englishName"],["pInputText","","formControlName","englishName","id","englishName","aria-describedby","englishName-help",3,"placeholder"],["formArrayName","variantValues"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","disabled","label"],[1,"error-message"],[3,"formGroupName"],[1,"flex","align-items-center"],[1,"field","col-5"],["pInputText","","formControlName","arabicName","aria-describedby","arabicName-help",3,"placeholder","id"],[1,"field","md:col-5"],["pInputText","","formControlName","englishName","aria-describedby","englishName-help",3,"placeholder","id"],[1,"field","col-2"],["severity","primary","icon","pi pi-plus",3,"click"],["severity","danger","icon","pi pi-minus",3,"click"]],template:function(a,i){a&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-multiSelect",3),o(4,"translate"),g(5,ct,1,1,"ng-template",4),r(),g(6,dt,4,8,"div",5),r()(),s(7,"div",6)(8,"div",7)(9,"div",8)(10,"label",9),m(11),o(12,"translate"),r(),S(13,"input",10),o(14,"translate"),g(15,mt,4,8,"div",5)(16,ut,3,5,"div",5),r()(),s(17,"div",7)(18,"div",8)(19,"label",11),m(20),o(21,"translate"),r(),S(22,"input",12),o(23,"translate"),g(24,ft,4,8,"div",5)(25,_t,3,5,"div",5),r()()(),s(26,"div",13),g(27,vt,25,21,"div",14),r(),s(28,"div",15)(29,"p-button",16),o(30,"translate"),_("onClick",function(){return i.onClose()}),r(),s(31,"p-button",17),o(32,"translate"),o(33,"translate"),_("onClick",function(){return i.onSave()}),r()()()),a&2&&(p("formGroup",i.addVariantForm),n(3),p("options",i.classifications)("filter",!0)("placeholder",c(4,17,"FIELDS.CLASSIFICATION")),n(3),p("ngIf",i.control.classificationIds.touched&&(i.control.classificationIds.errors==null?null:i.control.classificationIds.errors.required)),n(5),b(c(12,19,"FIELDS.ARABIC_NAME")),n(2),p("placeholder",c(14,21,"FIELDS.ARABIC_NAME")),n(2),p("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.required)),n(),p("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.maxlength)),n(4),b(c(21,23,"FIELDS.ENGLISH_NAME")),n(2),p("placeholder",c(23,25,"FIELDS.ENGLISH_NAME")),n(2),p("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.required)),n(),p("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.maxlength)),n(2),p("ngForOf",i.variantValues.controls),n(2),p("label",c(30,27,"GENERAL.CANCEL")),n(2),p("disabled",i.addVariantForm.invalid)("label",i.variantsData?c(32,29,"GENERAL.UPDATE"):c(33,31,"GENERAL.SAVE")))},dependencies:[V,Xe,fe,he,Q,W,Y,ee,Z,J,Qe,We,j,ae,H,ie,X,x,R,se,ge,we]})}return t})();var wi=t=>({fieldName:t}),Ri=()=>({maxLength:50});function bt(t,u){t&1&&(s(0,"div",20),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,wi,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function It(t,u){t&1&&(s(0,"div",20),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,Ri))," "))}function St(t,u){t&1&&(s(0,"div",20),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,wi,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function At(t,u){t&1&&(s(0,"div",20),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,Ri))," "))}function Nt(t,u){if(t&1){let e=U();s(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"label",11),m(6),o(7,"translate"),r(),S(8,"input",12),o(9,"translate"),g(10,bt,4,8,"div",13)(11,It,3,5,"div",13),r()(),s(12,"div",14)(13,"div",10)(14,"label",11),m(15),o(16,"translate"),r(),S(17,"input",15),o(18,"translate"),g(19,St,4,8,"div",13)(20,At,3,5,"div",13),r()(),s(21,"div",16)(22,"div",17)(23,"p-button",18),_("click",function(){B(e);let i=A();return w(i.addNewVariants())}),r(),s(24,"p-button",19),_("click",function(){let i=B(e).index,l=A();return w(l.removeVariants(i))}),r()()()()()()}if(t&2){let e,a,i,l,d=u.index,$=A();p("formGroupName",d),n(6),b(c(7,13,"FIELDS.ARABIC_NAME")),n(2),De("id","arabicName",d,""),p("placeholder",c(9,15,"FIELDS.ARABIC_NAME")),n(2),p("ngIf",((e=$.variantValues.at(d).get("arabicName"))==null?null:e.touched)&&((e=$.variantValues.at(d).get("arabicName"))==null?null:e.hasError("required"))),n(),p("ngIf",((a=$.variantValues.at(d).get("arabicName"))==null?null:a.touched)&&((a=$.variantValues.at(d).get("arabicName"))==null?null:a.hasError("maxlength"))),n(4),b(c(16,17,"FIELDS.ENGLISH_NAME")),n(2),De("id","englishName",d,""),p("placeholder",c(18,19,"FIELDS.ENGLISH_NAME")),n(2),p("ngIf",((i=$.variantValues.at(d).get("englishName"))==null?null:i.touched)&&((i=$.variantValues.at(d).get("englishName"))==null?null:i.hasError("required"))),n(),p("ngIf",((l=$.variantValues.at(d).get("englishName"))==null?null:l.touched)&&((l=$.variantValues.at(d).get("englishName"))==null?null:l.hasError("maxlength")))}}var Mi=(()=>{class t{fb;addVariantValueForm;save=new ue;closeVariantValue=new ue;classifications=[];breadcrumb;variantsData;constructor(e){this.fb=e}ngOnInit(){this.initForm()}initForm(){this.addVariantValueForm=this.fb.group({id:[0],variantValues:this.fb.array([this.createVariantGroup()])})}addNewVariants(){this.variantValues.push(this.createVariantGroup())}removeVariants(e){this.variantValues.removeAt(e)}get variantValues(){return this.addVariantValueForm.get("variantValues")}createVariantGroup(){return this.fb.group({id:[0],arabicName:["",[E.required,E.maxLength(50)]],englishName:["",[E.required,E.maxLength(50)]]})}get control(){return this.addVariantValueForm.controls}onSave(){this.addVariantValueForm.valid&&(this.variantsData&&this.addVariantValueForm.get("id")?.setValue(this.variantsData.id),this.save.emit(this.addVariantValueForm.value))}onClose(){this.closeVariantValue.emit()}static \u0275fac=function(a){return new(a||t)(f(K))};static \u0275cmp=y({type:t,selectors:[["admin-add-variants-value"]],inputs:{classifications:"classifications",variantsData:"variantsData"},outputs:{save:"save",closeVariantValue:"closeVariantValue"},standalone:!0,features:[L],decls:8,vars:9,consts:[[1,"p-fluid","formgrid",3,"formGroup"],["formArrayName","variantValues"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","disabled","label"],[3,"formGroupName"],[1,"grid"],[1,"flex","align-items-center"],[1,"field","col-5"],[1,"flex","flex-column","gap-2"],["for","arabicName"],["pInputText","","formControlName","arabicName","aria-describedby","arabicName-help",3,"placeholder","id"],["class","error-message",4,"ngIf"],[1,"field","md:col-5"],["pInputText","","type","text","formControlName","englishName",3,"id","placeholder"],[1,"field","col-2"],[1,"flex","gap-2","mt-1","align-items-center","justify-content-end"],["severity","primary","icon","pi pi-plus",3,"click"],["severity","danger","icon","pi pi-minus",3,"click"],[1,"error-message"]],template:function(a,i){a&1&&(s(0,"div",0)(1,"div",1),g(2,Nt,25,21,"div",2),r(),s(3,"div",3)(4,"p-button",4),o(5,"translate"),_("onClick",function(){return i.onClose()}),r(),s(6,"p-button",5),o(7,"translate"),_("onClick",function(){return i.onSave()}),r()()()),a&2&&(p("formGroup",i.addVariantValueForm),n(2),p("ngForOf",i.variantValues.controls),n(2),p("label",c(5,5,"GENERAL.CANCEL")),n(2),p("disabled",i.addVariantValueForm.invalid)("label",c(7,7,"GENERAL.SAVE")))},dependencies:[V,Xe,fe,he,Q,W,Y,ee,Z,J,Qe,We,H,ie,x,R,j,ae]})}return t})();var Ui={columns:[{field:"arabicName",header:"VARIANTNAME",type:"label",exported:!1},{field:"variantsValueProp",header:"VARIANTVALUE",type:"label",exported:!1},{field:"classification",header:"CLASSIFICATION",type:"label",exported:!1},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",actions:["CREATE"],rowsActions:["EDIT","DELETE"],paginator:!0,locale:"FIELDS.",dataLoading:"server",hasFilters:!0};var Gi=(()=>{class t{_http;constructor(e){this._http=e}getAllVariants(e){return this._http.get(`${F.URL_API}Variants?PageSize=${e.size}&PageNumber=${e.number}`)}getVariantById(e){return this._http.get(`${F.URL_API}Variants/${e}/Details`)}editVariant(e){return this._http.put(`${F.URL_API}Variants`,e)}addVariant(e){return this._http.post(`${F.URL_API}Variants`,e)}addVariantValue(e){return this._http.post(`${F.URL_API}Variants/variantValues`,e)}static \u0275fac=function(a){return new(a||t)(me(_e))};static \u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Pi=()=>({width:"600px",height:"100vh",top:"0",margin:"0",padding:"0"});function Ft(t,u){if(t&1&&(s(0,"div",10)(1,"div"),m(2),r()()),t&2){let e=u.$implicit;n(2),b(e.name)}}function yt(t,u){t&1&&(m(0),o(1,"translate")),t&2&&h(" ",c(1,1,"VARIANTS.EDIT_VARIANT")," ")}function Lt(t,u){t&1&&(m(0),o(1,"translate")),t&2&&h(" ",c(1,1,"VARIANTS.ADD_NEW_VARIANT")," ")}function Vt(t,u){if(t&1){let e=U();s(0,"div",11)(1,"div",12),g(2,yt,2,3)(3,Lt,2,3),r(),s(4,"button",13),_("click",function(){B(e);let i=A();return w(i.displayDialog=!1)}),S(5,"img",14),r()()}if(t&2){let e=A();n(2),M(e.selectedVariant?2:3)}}function xt(t,u){if(t&1){let e=U();s(0,"admin-add-edit-variants",15),_("closeVariantValue",function(){B(e);let i=A();return w(i.onDialogClose("ADD_FULL"))})("save",function(i){B(e);let l=A();return w(l.handleSave(i))}),r()}if(t&2){let e=A();p("classifications",e.classifications)("variantsData",e.selectedVariant)}}function Bt(t,u){if(t&1){let e=U();s(0,"div",11)(1,"div",12),m(2),o(3,"translate"),r(),s(4,"button",13),_("click",function(){B(e);let i=A();return w(i.displayVariantValueDialog=!1)}),S(5,"img",14),r()()}t&2&&(n(2),b(c(3,1,"VARIANTS.ADD_NEW_VARIANT")))}function wt(t,u){if(t&1){let e=U();s(0,"admin-add-variants-value",15),_("closeVariantValue",function(){B(e);let i=A();return w(i.onDialogClose("ADD_VARIANT_VALUE"))})("save",function(i){B(e);let l=A();return w(l.handleVariantValueSave(i))}),r()}if(t&2){let e=A();p("classifications",e.classifications)("variantsData",e.selectedVariant)}}var Dr=(()=>{class t{_confirm;_product;_variants;_toastr;_translate;_unsubscribeAll=new G;classifications=[];selectedClassification=null;searchControl=new pe;breadcrumb;filters={number:1,size:10};selectedVariant=null;tableConfig;displayDialog=!1;displayVariantValueDialog=!1;constructor(e,a,i,l,d){this._confirm=e,this._product=a,this._variants=i,this._toastr=l,this._translate=d}ngOnInit(){this.getClassifications(),this.getAllVariants(this.filters),this.onSearchData()}getClassifications(){this._product.getClassifications().pipe(v(this._unsubscribeAll)).subscribe(e=>{this.classifications=e.data.classifications})}onSearchData(){this.searchControl.valueChanges.pipe(Se(e=>e.trim()?.length>0),Ae(400),Ne(e=>this._product.searchVariants(e))).subscribe(e=>this.tableConfig.rows=e.data.result.map(a=>T(N({},a),{classification:a.classificationIds.map(i=>i.name).join(", "),variantsValueProp:a.variantValues.map(i=>i.name).join(", ")}))||[])}filterVariants(e){this.selectedClassification?this._variants.getAllVariants(e).pipe(v(this._unsubscribeAll)).subscribe(a=>{let i=a.data.result.filter(l=>l.classificationIds.find(d=>d.name==this.selectedClassification?.name));this.tableConfig.rows=i.map(l=>T(N({},l),{classification:l.classificationIds.map(d=>d.name).join(", "),variantsValueProp:l.variantValues.map(d=>d.name).join(", ")}))}):this.getAllVariants(this.filters)}onPageChange(e){this.filters={size:e.rows||10,number:e.page||1},this.getAllVariants(this.filters)}getAllVariants(e){this._variants.getAllVariants(e).pipe(v(this._unsubscribeAll)).subscribe(a=>{this.tableConfig=T(N({},Ui),{rows:a.data.result,totalRecords:a.data.rowCount}),this.tableConfig.rows=a.data.result.map(i=>T(N({},i),{classification:i.classificationIds.map(l=>l.name).join(", "),variantsValueProp:i.variantValues.map(l=>l.name).join(", ")}))||[]})}onActionClicked(e){switch(e.action){case"CREATE":this.selectedVariant=null,this.openCreateDialog("ADD_FULL");break;case"ADD_VARIANT_VALUE":this.selectedVariant=e.data,this.openCreateDialog("ADD_VARIANT_VALUE");break;case"DELETE":this.ondeleteVariant(e.data);break;case"EDIT":this.getVariantById(+e.data.id);break;default:break}}getVariantById(e){this._variants.getVariantById(e).pipe(v(this._unsubscribeAll)).subscribe(a=>{this.selectedVariant=a.data||[],this.openCreateDialog("ADD_FULL")})}openCreateDialog(e){e==="ADD_FULL"?this.displayDialog=!0:e==="ADD_VARIANT_VALUE"&&(this.displayVariantValueDialog=!0)}onDialogClose(e){e==="ADD_FULL"?this.displayDialog=!1:e==="ADD_VARIANT_VALUE"&&(this.displayVariantValueDialog=!1)}onClassificationChange(e){this.selectedClassification=e.value,this.filterVariants(this.filters)}handleSave(e){e.classificationIds&&(e.classificationIds=e.classificationIds.map(a=>a.id?a.id:a)),this.selectedVariant?this._variants.editVariant(T(N({},e),{id:this.selectedVariant.id})).pipe(v(this._unsubscribeAll)).subscribe(a=>{if(a.data){let l=this._translate.currentLang==="ar"?this.selectedVariant?.arabicName:this.selectedVariant?.englishName;this._translate.get("GENERAL.UPDATED_SUCCESSFULLY",{name:l}).subscribe(d=>{this._toastr.success(d)}),this.getAllVariants(this.filters),this.displayDialog=!1}}):this._variants.addVariant(e).pipe(v(this._unsubscribeAll)).subscribe(()=>{this.getAllVariants(this.filters),this.displayDialog=!1;let i=this._translate.currentLang==="ar"?"\u0645\u062A\u063A\u064A\u0631":"Variant";this._translate.get("GENERAL.ADDED_SUCCESSFULLY",{name:i}).subscribe(l=>{this._toastr.success(l)})})}ondeleteVariant(e){this._confirm.confirm("delete").subscribe(a=>{a&&e.id&&this._product.deleteVariant(e.id).pipe(v(this._unsubscribeAll)).subscribe(i=>{i.data&&(this._toastr.success("Variant Deleted Successfully"),this.getAllVariants(this.filters))})})}handleVariantValueSave(e){this._variants.addVariantValue(e).pipe(v(this._unsubscribeAll)).subscribe(()=>{this.getAllVariants(this.filters),this.displayVariantValueDialog=!1,this._translate.get("GENERAL.ADDED_SUCCESSFULLY").subscribe(a=>{this._toastr.success(a)})})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static \u0275fac=function(a){return new(a||t)(f(re),f(Ce),f(Gi),f(k),f(P))};static \u0275cmp=y({type:t,selectors:[["admin-variants"]],standalone:!0,features:[L],decls:15,vars:29,consts:[[1,"dialog-side"],[3,"actionClicked","onPage","onSearch","config"],["filters-area","",1,"filters","p-grid"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["formControlName","classification","optionLabel","name","filterBy","name","placeholder","Select a classifications",1,"w-full",3,"onChange","options","filter","showClear"],["pTemplate","selectedItem"],[3,"visibleChange","visible","modal","dismissableMask","position","baseZIndex","draggable","blockScroll","closable"],["pTemplate","header"],["pTemplate","content"],[1,"flex","align-items-center","gap-2"],[1,"dialog-header"],[1,"dialog-header__title"],[1,"dialog-header__close-button",3,"click"],["src","assets/layout/images/close-icon.svg","alt","Close",1,"dialog-header__close-icon"],[3,"closeVariantValue","save","classifications","variantsData"]],template:function(a,i){a&1&&(s(0,"section",0)(1,"shared-ui-table",1),_("actionClicked",function(d){return i.onActionClicked(d)})("onPage",function(d){return i.onPageChange(d)})("onSearch",function(d){return i.searchControl.patchValue(d)}),s(2,"div",2)(3,"div",3),m(4),o(5,"translate"),r(),s(6,"div",4)(7,"p-dropdown",5),_("onChange",function(d){return i.onClassificationChange(d)}),g(8,Ft,3,1,"ng-template",6),r()()()(),s(9,"p-dialog",7),$e("visibleChange",function(d){return je(i.displayDialog,d)||(i.displayDialog=d),d}),g(10,Vt,6,1,"ng-template",8)(11,xt,1,2,"ng-template",9),r(),s(12,"p-dialog",7),$e("visibleChange",function(d){return je(i.displayVariantValueDialog,d)||(i.displayVariantValueDialog=d),d}),g(13,Bt,6,3,"ng-template",8)(14,wt,1,2,"ng-template",9),r()()),a&2&&(n(),p("config",i.tableConfig),n(3),b(c(5,25,"GENERAL.FILTERS")),n(3),p("options",i.classifications)("filter",!0)("showClear",!0),n(2),ke(D(27,Pi)),Oe("visible",i.displayDialog),p("modal",!0)("dismissableMask",!0)("position","right")("baseZIndex",1e4)("draggable",!1)("blockScroll",!0)("closable",!1),n(3),ke(D(28,Pi)),Oe("visible",i.displayVariantValueDialog),p("modal",!0)("dismissableMask",!0)("position","right")("baseZIndex",1e4)("draggable",!1)("blockScroll",!0)("closable",!1))},dependencies:[V,ne,H,X,Bi,O,te,oe,Ye,x,R,Mi],encapsulation:2})}return t})();var ii=(()=>{class t{_http;constructor(e){this._http=e}getClassifications(){return this._http.get(`${F.URL_API}Classifications`)}getBrands(e){return this._http.get(`${F.URL_API}Brands?PageSize=${e.size}&PageNumber=${e.number}`)}addBrand(e){return this._http.post(`${F.URL_API}Brands`,e)}deleteBrand(e){return this._http.delete(`${F.URL_API}Brands/${e}`)}editBrand(e){return this._http.put(`${F.URL_API}Brands`,e)}getBrandById(e){return this._http.get(`${F.URL_API}Brands/${e}`)}static \u0275fac=function(a){return new(a||t)(me(_e))};static \u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Oi=t=>({"ng-dirty ng-invalid":t}),hi=t=>({fieldName:t}),ji=()=>({maxLength:50});function Rt(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,hi,c(2,1,"FIELDS.classificationIds")))," "))}function Mt(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,hi,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function Ut(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ji))," "))}function Gt(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,hi,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function Pt(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ji))," "))}function kt(t,u){if(t&1){let e=U();s(0,"div",11),S(1,"img",15),s(2,"img",16),_("click",function(){B(e);let i=A();return w(i.removeFile())}),r()()}if(t&2){let e=A();n(),p("src",e.brand.icon==null?null:e.brand.icon.blobUrI,Te)("alt",e.brand.icon==null?null:e.brand.icon.id)}}function Ot(t,u){if(t&1){let e=U();s(0,"label",17),m(1,"Brand Icon"),r(),s(2,"p-fileUpload",18),_("onSelect",function(i){B(e);let l=A();return w(l.uploadFile(i))}),r()}t&2&&(n(2),p("showUploadButton",!1)("showCancelButton",!1)("maxFileSize",1e6))}var gi=(()=>{class t{_product;_popup;_translate;_toastr;_fb;destroy$=new G;formError;brandForm;brand;selectedBrands;classifications=[];constructor(e,a,i,l,d){this._product=e,this._popup=a,this._translate=i,this._toastr=l,this._fb=d}ngOnInit(){this.brand=this._popup.getData(),this.brandForm=this.initForm(),this.formError=new Le.ErrorManagement(this.brandForm),this.brand.id&&this.getBrandDetails(),this.getClassifications()}getBrandDetails(){this._product.getBrandById(this.brand.id).pipe(v(this.destroy$)).subscribe({next:e=>{this.brand=e.data,this.selectedBrands||(this.selectedBrands={classificationModels:[],classificationIds:[]}),this.selectedBrands.classificationIds=(this.brand.classificationModels||[]).map(a=>a.id||0),this.brand.id&&this.patchFormData()}})}initForm(){return this._fb.group({id:[0],classificationIds:[[],[E.required]],arabicName:["",[E.required]],englishName:["",[E.required]],serviceType:[null,[E.required]],icon:this._fb.group({id:0,externalStorageId:"",mimeType:"",has360View:!1,sizeInBytes:0,blobUrI:""})})}patchFormData(){this.brandForm.patchValue({id:this.brand.id,classificationIds:this.selectedBrands.classificationIds||[],arabicName:this.brand.arabicName,englishName:this.brand.englishName,icon:this.brand.icon||{}}),console.log("Form Value Inside patchFormData:",this.brandForm.value);let e=this.brandForm.get("icon");this.brand.icon&&e.patchValue({id:this.brand.icon.id,externalStorageId:this.brand.icon.externalStorageId,mimeType:this.brand.icon.mimeType,has360View:this.brand.icon.has360View,sizeInBytes:this.brand.icon.sizeInBytes,blobUrI:this.brand.icon.blobUrI})}uploadFile(e){let a=e.files;if(a.length>0){let i=a[0];this.brandForm.get("icon").patchValue({id:0,externalStorageId:i.name,mimeType:i.type,sizeInBytes:i.size,has360View:!0,blobUrl:URL.createObjectURL(i)})}}removeFile(){this.brandForm.get("icon")?.get("blobUrI")?.setValue(""),this.brand.icon&&(this.brand.icon.blobUrI=void 0)}save(){let e=this.brandForm.getRawValue();(e.id?this._product.editBrand(e):this._product.addBrand(e)).pipe(v(this.destroy$)).subscribe(()=>this.afterSavingDone(e.id?"edit":"add",e))}afterSavingDone(e,a){let i=this._translate.currentLang==="ar"?a?.arabicName:a?.englishName;this._translate.get(e?"GENERAL.ADDED_SUCCESSFULLY":"UPDATED_SUCCESSFULLY",{name:i}).subscribe(l=>this._toastr.success(l)),this._popup.close(!0)}close=()=>this._popup.close();onClassificationChange(e){this.brandForm.get("classificationId")?.setValue(e.value.id),this.brandForm.get("classification")?.setValue(e.value)}getClassifications(){this._product.getClassifications().pipe(v(this.destroy$)).subscribe({next:e=>{this.classifications=e.data.classifications}})}static \u0275fac=function(a){return new(a||t)(f(ii),f(z),f(P),f(k),f(K))};static \u0275cmp=y({type:t,selectors:[["admin-brands-form"]],standalone:!0,features:[L],decls:34,vars:42,consts:[["autocomplete","off",3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],["for","classificationIds"],["formControlName","classificationIds","optionLabel","name","optionValue","id","filterBy","name",3,"onChange","options","filter","showClear","placeholder"],["id","serviceType-error",1,"text-error"],[1,"field","col-12","md:col-6"],["for","englishName"],["pInputText","","type","text","pInputText","","formControlName","englishName",1,"w-full",3,"ngClass","placeholder"],["for","arabicName"],["type","text","pInputText","","formControlName","arabicName",1,"w-full",3,"ngClass","placeholder"],[1,"container-img"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","label"],[3,"src","alt"],["src","assets/layout/images/close-icon.svg","alt","close-icon",1,"close",3,"click"],["for","icon"],["name","icon","id","icon","accept","image/*",3,"onSelect","showUploadButton","showCancelButton","maxFileSize"]],template:function(a,i){a&1&&(s(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),m(4),o(5,"translate"),r(),s(6,"p-multiSelect",4),o(7,"translate"),_("onChange",function(d){return i.onClassificationChange(d)}),r(),g(8,Rt,4,8,"small",5),r(),s(9,"div",6)(10,"label",7),m(11),o(12,"translate"),r(),S(13,"input",8),o(14,"translate"),g(15,Mt,4,8,"small",5)(16,Ut,3,5,"small",5),r(),s(17,"div",6)(18,"label",9),m(19),o(20,"translate"),r(),S(21,"input",10),o(22,"translate"),g(23,Gt,4,8,"small",5)(24,Pt,3,5,"small",5),r(),s(25,"div",2),g(26,kt,3,2,"div",11)(27,Ot,3,3),r()()(),s(28,"div",12)(29,"p-button",13),o(30,"translate"),_("onClick",function(){return i.close()}),r(),s(31,"p-button",14),o(32,"translate"),o(33,"translate"),_("onClick",function(){return i.save()}),r()()),a&2&&(p("formGroup",i.brandForm),n(4),b(c(5,20,"FIELDS.CLASSIFICATIONS")),n(2),p("options",i.classifications)("filter",!0)("showClear",!0)("placeholder",c(7,22,"FIELDS.CLASSIFICATIONS")),n(2),M(i.formError.hasSpecificError("classificationIds","required")?8:-1),n(3),b(c(12,24,"FIELDS.ENGLISH_NAME")),n(2),p("ngClass",I(38,Oi,i.formError.hasError("englishName")))("placeholder",c(14,26,"FIELDS.ENGLISH_NAME")),n(2),M(i.formError.hasSpecificError("englishName","required")?15:-1),n(),M(i.formError.hasSpecificError("englishName","maxlength")?16:-1),n(3),b(c(20,28,"FIELDS.ARABIC_NAME")),n(2),p("ngClass",I(40,Oi,i.formError.hasError("arabicName")))("placeholder",c(22,30,"FIELDS.ARABIC_NAME")),n(2),M(i.formError.hasSpecificError("arabicName","required")?23:-1),n(),M(i.formError.hasSpecificError("arabicName","maxlength")?24:-1),n(2),M(i.brand.icon!=null&&i.brand.icon.blobUrI?26:27),n(3),p("label",c(30,32,"GENERAL.CANCEL")),n(2),p("label",i.brand.id?c(32,34,"GENERAL.UPDATE"):c(33,36,"GENERAL.SAVE")))},dependencies:[V,Fe,ee,Ve,Q,W,Y,Z,J,O,j,ae,se,ge,H,ie,x,R,Be,xe]})}return t})();var Ci={columns:[{field:"name",header:"BRANDNAME",type:"label",exported:!1},{field:"classifications",header:"CLASSIFICATION",type:"label",exported:!0},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",locale:"FIELDS.",actions:["CREATE"],rowsActions:["EDIT","DELETE"],dataLoading:"server",paginator:!0,globalFilterFields:["name"],hasFilters:!0};function jt(t,u){if(t&1&&(s(0,"div",6)(1,"div"),m(2),r()()),t&2){let e=u.$implicit;n(2),b(e.name)}}var _o=(()=>{class t{_brands;_confirm;_translate;_popup;_toast;destroy$=new G;tableConfig$;filters={number:1,size:10};searchControl=new pe;classifications=[];currentPage=1;totalRecords=0;first=0;pageSize=10;rows=10;selectedClassification=null;constructor(e,a,i,l,d){this._brands=e,this._confirm=a,this._translate=i,this._popup=l,this._toast=d}ngOnInit(){this.getAllBrand(this.filters),this.getClassifications()}getAllBrand(e){this._brands.getBrands(e).pipe(Ie(a=>T(N({},Ci),{rows:a.data?.result.map(i=>T(N({},i),{classifications:(i.classifications||[]).map(l=>l.name)}))||[],totalRecords:a.data?.rowCount}))).subscribe({next:a=>{this.tableConfig$=be(a)}})}onActionClicked(e){switch(e.action){case"CREATE":this.createBrand();break;case"EDIT":this.editBrand(e.data);break;case"DELETE":this.deleteBrand(e.data);break}}createBrand(){this._popup.open(gi,{title:this._translate.instant("BRANDS.ADD_NEW_BRAND"),position:this._translate.currentLang==="ar"?"left":"right"}).afterClosed.subscribe(e=>e&&this.getAllBrand(this.filters))}editBrand(e){this._popup.open(gi,{title:this._translate.instant("BRANDS.EDIT_BRAND"),position:this._translate.currentLang==="ar"?"left":"right",data:e}).afterClosed.subscribe(a=>a&&this.getAllBrand(this.filters))}deleteBrand(e){e.id&&this._confirm.confirm("delete").subscribe(a=>{a&&this._brands.deleteBrand(e.id).pipe(v(this.destroy$)).subscribe(()=>{this._toast.success(this._translate.instant("BRANDS.DELETE_BRAND_SUCCESS")),this.getAllBrand(this.filters)})})}getClassifications(){this._brands.getClassifications().pipe(v(this.destroy$)).subscribe(e=>{this.classifications=e.data.classifications})}onClassificationChange(e){this.selectedClassification=e.value,this.filterWithClassifications()}filterWithClassifications(){this.selectedClassification?this._brands.getBrands({size:this.rows,number:this.currentPage}).pipe(v(this.destroy$)).subscribe({next:e=>{let a=e.data.result.filter(i=>i.classifications.some(l=>l.id===this.selectedClassification?.id));this.tableConfig$=be(T(N({},Ci),{rows:a.map(i=>T(N({},i),{classifications:(i.classifications||[]).map(l=>l.name).join(", ")}))||[],totalRecords:a.length}))}}):this.getAllBrand({size:this.rows,number:this.currentPage})}onPageChange(e){this.first=e.first||0,this.rows=e.rows||10,this.currentPage=e.page||1,console.log("PageSize:",this.rows,"PageNumber:",this.currentPage),this.getAllBrand({size:this.rows,number:this.currentPage})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(f(ii),f(re),f(P),f(z),f(k))};static \u0275cmp=y({type:t,selectors:[["admin-brands"]],standalone:!0,features:[L],decls:9,vars:9,consts:[[3,"actionClicked","onSearch","onPage","config"],["filters-area","",1,"filters","p-grid"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["formControlName","classification","optionLabel","name","filterBy","name","placeholder","Select a classifications",1,"w-full",3,"onChange","options","filter","showClear"],["pTemplate","selectedItem"],[1,"flex","align-items-center","gap-2"]],template:function(a,i){a&1&&(s(0,"shared-ui-table",0),o(1,"async"),_("actionClicked",function(d){return i.onActionClicked(d)})("onSearch",function(d){return i.searchControl.patchValue(d)})("onPage",function(d){return i.onPageChange(d)}),s(2,"div",1)(3,"div",2),m(4),o(5,"translate"),r(),s(6,"div",3)(7,"p-dropdown",4),_("onChange",function(d){return i.onClassificationChange(d)}),g(8,jt,3,1,"ng-template",5),r()()()()),a&2&&(p("config",c(1,5,i.tableConfig$)),n(4),b(c(5,7,"GENERAL.FILTERS")),n(3),p("options",i.classifications)("filter",!0)("showClear",!0))},dependencies:[V,ye,ne,j,O,te,X,se,oe,x,R],encapsulation:2})}return t})();var qe=t=>({fieldName:t}),ti=()=>({maxLength:50});function $t(t,u){if(t&1&&(s(0,"div",11)(1,"div"),m(2),r()()),t&2){let e=u.$implicit;n(2),b(e.name)}}function Ht(t,u){t&1&&(s(0,"div",16),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,qe,c(2,1,"FIELDS.CLASSIFICATION")))," "))}function zt(t,u){t&1&&(s(0,"div",16),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,qe,c(2,1,"FIELDS.SHORT_ARABIC_NAME")))," "))}function qt(t,u){t&1&&(s(0,"div",16),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ti))," "))}function Xt(t,u){t&1&&(s(0,"div",16),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,qe,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function Qt(t,u){t&1&&(s(0,"div",16),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ti))," "))}function Wt(t,u){t&1&&(s(0,"div",16),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,qe,c(2,1,"FIELDS.SHORT_ARABIC_NAME")))," "))}function Yt(t,u){t&1&&(s(0,"div",16),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ti))," "))}function Zt(t,u){t&1&&(s(0,"div",16),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,qe,c(2,1,"FIELDS.SHORT_ENGLISH_NAME")))," "))}function Jt(t,u){t&1&&(s(0,"div",16),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,ti))," "))}var $i=(()=>{class t{_fb;classifications=[];unitData;addUnitForm;save=new ue;constructor(e){this._fb=e}ngOnInit(){if(this.prepareForm(),this.unitData&&(this.addUnitForm.patchValue(this.unitData),this.unitData.classificationId)){let e=Number(this.unitData.classificationId),a=this.classifications.find(i=>i.id===e);a&&this.addUnitForm.get("classification")?.setValue(a)}}prepareForm(){this.addUnitForm=this._fb.group({childId:[],arabicName:[null,[E.required,E.maxLength(50)]],englishName:[null,[E.required,E.maxLength(50)]],classificationId:[null,E.required],classification:[null,E.required],shortArabicName:[null,[E.required,E.maxLength(50)]],shortEnglishName:[null,[E.required,E.maxLength(50)]],isDecimal:[!0]})}get control(){return this.addUnitForm.controls}onClassificationChange(e){this.addUnitForm.get("classificationId")?.setValue(e.value.id),this.addUnitForm.get("classification")?.setValue(e.value)}onSave(){this.addUnitForm.valid?this.save.emit(this.addUnitForm.value):this.addUnitForm.markAllAsTouched()}static \u0275fac=function(a){return new(a||t)(f(K))};static \u0275cmp=y({type:t,selectors:[["admin-add-edit-units"]],inputs:{classifications:"classifications",unitData:"unitData"},outputs:{save:"save"},standalone:!0,features:[L],decls:37,vars:37,consts:[[1,"form-content",3,"formGroup"],[1,"row"],[1,"col-12"],["formControlName","classification","optionLabel","name","filterBy","name",3,"onChange","options","filter","showClear","placeholder"],["pTemplate","selectedItem"],["class","error-message",4,"ngIf"],[1,"col-6"],["type","text","pInputText","","formControlName","arabicName",1,"w-full",3,"placeholder"],["type","text","pInputText","","formControlName","englishName",1,"w-full",3,"placeholder"],["type","text","pInputText","","formControlName","shortArabicName",1,"w-full",3,"placeholder"],["type","text","pInputText","","formControlName","shortEnglishName",1,"w-full",3,"placeholder"],[1,"flex","align-items-center","gap-2"],["formControlName","isDecimal","inputId","binary",3,"binary"],["for","ny"],[1,"col-3"],[1,"p-element","btn-tasheel","btn-primary","w-full",3,"onClick","label"],[1,"error-message"]],template:function(a,i){a&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-dropdown",3),o(4,"translate"),_("onChange",function(d){return i.onClassificationChange(d)}),g(5,$t,3,1,"ng-template",4),r(),g(6,Ht,4,8,"div",5),r(),s(7,"div",6),S(8,"input",7),o(9,"translate"),g(10,zt,4,8,"div",5)(11,qt,3,5,"div",5),r(),s(12,"div",6),S(13,"input",8),o(14,"translate"),g(15,Xt,4,8,"div",5)(16,Qt,3,5,"div",5),r(),s(17,"div",6),S(18,"input",9),o(19,"translate"),g(20,Wt,4,8,"div",5)(21,Yt,3,5,"div",5),r(),s(22,"div",6),S(23,"input",10),o(24,"translate"),g(25,Zt,4,8,"div",5)(26,Jt,3,5,"div",5),r(),s(27,"div",2)(28,"div",11),S(29,"p-checkbox",12),s(30,"label",13),m(31),o(32,"translate"),r()()(),s(33,"div",14)(34,"p-button",15),o(35,"translate"),o(36,"translate"),_("onClick",function(){return i.onSave()}),r()()()()),a&2&&(p("formGroup",i.addUnitForm),n(3),p("options",i.classifications)("filter",!0)("showClear",!0)("placeholder",c(4,21,"FIELDS.CLASSIFICATION")),n(3),p("ngIf",i.control.classification.touched&&(i.control.classification.errors==null?null:i.control.classification.errors.required)),n(2),p("placeholder",c(9,23,"FIELDS.SHORT_ARABIC_NAME")),n(2),p("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.required)),n(),p("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.maxlength)),n(2),p("placeholder",c(14,25,"FIELDS.ENGLISH_NAME")),n(2),p("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.required)),n(),p("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.maxlength)),n(2),p("placeholder",c(19,27,"FIELDS.SHORT_ARABIC_NAME")),n(2),p("ngIf",i.control.shortArabicName.touched&&(i.control.shortArabicName.errors==null?null:i.control.shortArabicName.errors.required)),n(),p("ngIf",i.control.shortArabicName.touched&&(i.control.shortArabicName.errors==null?null:i.control.shortArabicName.errors.maxlength)),n(2),p("placeholder",c(24,29,"FIELDS.SHORT_ENGLISH_NAME")),n(2),p("ngIf",i.control.shortEnglishName.touched&&(i.control.shortEnglishName.errors==null?null:i.control.shortEnglishName.errors.required)),n(),p("ngIf",i.control.shortEnglishName.touched&&(i.control.shortEnglishName.errors==null?null:i.control.shortEnglishName.errors.maxlength)),n(3),p("binary",!0),n(2),b(c(32,31,"FIELDS.ALLOW_DECIMAL")),n(3),p("label",i.unitData?c(35,33,"GENERAL.UPDATE"):c(36,35,"GENERAL.SAVE")))},dependencies:[V,fe,he,Q,W,Y,O,te,X,x,R,we,Di,ee,Z,J,j,ae,H,ie]})}return t})();var ai={columns:[{field:"name",header:"UNIT_NAME",type:"label",exported:!1},{field:"shortName",header:"SHORT_NAME",type:"label",exported:!1},{field:"classification",header:"CLASSIFICATION",type:"label",exported:!1},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",locale:"FIELDS.",actions:["CREATE"],rowsActions:["EDIT","DELETE"],dataLoading:"server",paginator:!0};var Kt=()=>({width:"600px",height:"100vh",top:"0",margin:"0",padding:"0"});function ea(t,u){if(t&1&&(s(0,"div",11)(1,"div"),m(2),r()()),t&2){let e=u.$implicit;n(2),b(e.name)}}function ia(t,u){if(t&1){let e=U();s(0,"div",12)(1,"div",13),m(2),o(3,"translate"),r(),s(4,"button",14),_("click",function(){B(e);let i=A();return w(i.displayDialog=!1)}),S(5,"img",15),r()()}t&2&&(n(2),b(c(3,1,"UNITS.ADD_NEW_UNIT")))}function ta(t,u){if(t&1){let e=U();s(0,"admin-add-edit-units",16),_("save",function(i){B(e);let l=A();return w(l.handleSave(i))}),r()}if(t&2){let e=A();p("classifications",e.classifications)("unitData",e.selectedUnit)}}var Qo=(()=>{class t{_toastr;_confirm;_translate;_product;_unsubscribeAll=new G;displayDialog=!1;pageSize=10;pageNumber=1;totalRecords=0;first=0;keyword="";searchControl=new pe;breadcrumb;tableConfig;classifications=[];selectedClassification=null;constructor(e,a,i,l){this._toastr=e,this._confirm=a,this._translate=i,this._product=l}ngOnInit(){this.tableConfig=ai,this.setBreadcrumb(),this.getClassifications(),this.getAllUnits(),this.onSearch(),this._translate.onLangChange.pipe(v(this._unsubscribeAll)).subscribe(e=>{this.setBreadcrumb()})}setBreadcrumb(){this.breadcrumb=[{icon:"pi pi-home",route:"/"},{label:this._translate.instant("UNITS.PRODUCT_MANAGEMENT")},{label:this._translate.instant("UNITS.NAME"),route:"/units"}]}getClassifications(){this._product.getClassifications().pipe(v(this._unsubscribeAll)).subscribe(e=>{this.classifications=e.data.classifications})}getAllUnits(){this._product.getAllUnits(this.pageSize,this.pageNumber,this.keyword).pipe(v(this._unsubscribeAll)).subscribe(e=>{this.tableConfig=T(N({},ai),{rows:e.data.result.map(a=>T(N({},a),{classification:a.classification?.name}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT","DELETE"]})})}onPageChange(e){this.first=e.first||0,this.pageSize=e.rows||10,this.pageNumber=e.page||1,this.getAllUnits()}onActionClicked(e){switch(e.action){case"CREATE":this.selectedUnit=null,this.openCreateDialog();break;case"EDIT":this.getUnitById(e.data);break;case"DELETE":this.onActionDelete(e.data);break;default:break}}openCreateDialog(){this.displayDialog=!0}onDialogClose(){this.displayDialog=!1}onActionDelete(e){this._confirm.confirm("delete").subscribe(a=>{a&&this._product.deleteUnit(e.id).pipe(v(this._unsubscribeAll)).subscribe(i=>{i.data&&this.getAllUnits()})})}handleSave(e){this.selectedUnit?this._product.editUnit(T(N({},e),{id:this.selectedUnit.id})).pipe(v(this._unsubscribeAll)).subscribe(a=>{a.data&&(this._toastr.success(this._translate.instant("GENERAL.UPDATED_SUCCESSFULLY",{name:"UNITS.NAME"})),this.getAllUnits(),this.displayDialog=!1)}):this._product.addUnit(e).pipe(v(this._unsubscribeAll)).subscribe(()=>{this.getAllUnits(),this.displayDialog=!1,this._toastr.success(this._translate.instant("GENERAL.ADDED_SUCCESSFULLY",{name:"UNITS.NAME"}))})}selectedUnit=null;getUnitById(e){let a=typeof e.id=="string"?Number(e.id):e.id;a&&this._product.getUnitById(a).subscribe(i=>{i.data&&(this.displayDialog=!0,this.selectedUnit=i.data)})}onClassificationChange(e){this.selectedClassification=e.value,this.filterUnits()}filterUnits(){this.selectedClassification?this._product.getAllUnits(this.pageSize,this.pageNumber,this.keyword).pipe(v(this._unsubscribeAll)).subscribe(e=>{let a=e.data.result.filter(i=>i.classification?.id===this.selectedClassification?.id);this.tableConfig.rows=a.map(i=>T(N({},i),{classification:i.classification?.name}))}):this.getAllUnits()}onSearch(){this.searchControl.valueChanges.pipe(Se(e=>e.trim().length>=0),Ae(400),Ne(e=>this._product.getAllUnits(this.pageSize,this.pageNumber,e.trim()))).subscribe(e=>{e&&e.data&&(this.tableConfig=T(N({},ai),{rows:e.data.result.map(a=>T(N({},a),{classification:a.classification?.name}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT","DELETE"]}))})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static \u0275fac=function(a){return new(a||t)(f(k),f(re),f(P),f(Ce))};static \u0275cmp=y({type:t,selectors:[["admin-units"]],standalone:!0,features:[L],decls:13,vars:19,consts:[[1,"dialog-side"],[3,"items"],[3,"onPage","onSearch","actionClicked","config"],["filters-area","",1,"filters","row"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["formControlName","classification","optionLabel","name","filterBy","name","placeholder","Select a classifications",1,"w-full",3,"onChange","options","filter","showClear"],["pTemplate","selectedItem"],[3,"visibleChange","visible","modal","dismissableMask","position","baseZIndex","draggable","blockScroll","closable"],["pTemplate","header"],["pTemplate","content"],[1,"flex","align-items-center","gap-2"],[1,"dialog-header"],[1,"dialog-header__title"],[1,"dialog-header__close-button",3,"click"],["src","assets/layout/images/close-icon.svg","alt","Close",1,"dialog-header__close-icon"],[3,"save","classifications","unitData"]],template:function(a,i){a&1&&(s(0,"section",0),S(1,"pos-ui-breadcrumb",1),s(2,"shared-ui-table",2),_("onPage",function(d){return i.onPageChange(d)})("onSearch",function(d){return i.searchControl.patchValue(d)})("actionClicked",function(d){return i.onActionClicked(d)}),s(3,"div",3)(4,"div",4),m(5),o(6,"translate"),r(),s(7,"div",5)(8,"p-dropdown",6),_("onChange",function(d){return i.onClassificationChange(d)}),g(9,ea,3,1,"ng-template",7),r()()()(),s(10,"p-dialog",8),$e("visibleChange",function(d){return je(i.displayDialog,d)||(i.displayDialog=d),d}),g(11,ia,6,3,"ng-template",9)(12,ta,1,2,"ng-template",10),r()()),a&2&&(n(),p("items",i.breadcrumb),n(),p("config",i.tableConfig),n(3),b(c(6,16,"GENERAL.FILTERS")),n(3),p("options",i.classifications)("filter",!0)("showClear",!0),n(2),ke(D(18,Kt)),Oe("visible",i.displayDialog),p("modal",!0)("dismissableMask",!0)("position","right")("baseZIndex",1e4)("draggable",!1)("blockScroll",!0)("closable",!1))},dependencies:[V,ne,O,te,X,$i,x,R,Ti,oe,Ye],encapsulation:2})}return t})();var ni=(()=>{class t{_http;constructor(e){this._http=e}getClassifications(){return this._http.get(`${F.URL_API}Classifications`)}getAllTags(e){return this._http.get(`${F.URL_API}Tags?TagTypeIds=2&PageSize=${e.size}&PageNumber=${e.number}`)}deleteTags(e){return this._http.delete(`${F.URL_API}Tags/${e}`)}addTags(e){return this._http.post(`${F.URL_API}Tags`,e)}editTags(e){return this._http.put(`${F.URL_API}Tags`,e)}getTagsById(e){return this._http.get(`/api/Tags/${e}`)}static \u0275fac=function(a){return new(a||t)(me(_e))};static \u0275prov=de({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var zi=t=>({"ng-dirty ng-invalid":t}),Ei=t=>({fieldName:t}),qi=()=>({maxLength:50});function aa(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,Ei,c(2,1,"FIELDS.classificationIds")))," "))}function na(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,Ei,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function ra(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,qi))," "))}function oa(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),h(" ",C(3,3,"GENERAL.FIELD_REQUIRED",I(6,Ei,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function sa(t,u){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),h(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",D(4,qi))," "))}var vi=(()=>{class t{_tag;_popup;_translate;_toastr;_fb;destroy$=new G;formError;tagForm;tag;classifications=[];selectedTag;constructor(e,a,i,l,d){this._tag=e,this._popup=a,this._translate=i,this._toastr=l,this._fb=d}ngOnInit(){this.tag=this._popup.getData(),this.tagForm=this.initForm(),this.formError=new Le.ErrorManagement(this.tagForm),this.tag&&this.tag.tagId&&this.getTagsDetails({tagId:this.tag.tagId}),this.getClassifications()}getClassifications(){this._tag.getClassifications().pipe(v(this.destroy$)).subscribe({next:e=>{this.classifications=e.data.classifications}})}getTagsDetails(e){let a=typeof e.tagId=="string"?Number(e.tagId):e.tagId;a&&!isNaN(a)&&this._tag.getTagsById(a).subscribe(i=>{i.data&&(this.selectedTag=i.data,this.selectedTag.classificationIds=(this.selectedTag.classificationIds||[]).map(l=>l.id),this.patchFormData())})}initForm(){return this._fb.group({classificationIds:[[],[E.required]],arabicName:["",[E.required]],englishName:["",[E.required]],TagTypeId:[2]})}patchFormData(){this.tagForm.patchValue({classificationIds:this.selectedTag.classificationIds||[],arabicName:this.selectedTag.arabicName,englishName:this.selectedTag.englishName})}save(){let e=this.tagForm.getRawValue();(e.id?this._tag.editTags(e):this._tag.addTags(e)).pipe(v(this.destroy$)).subscribe(()=>this.afterSavingDone(e.id?"edit":"add",e))}afterSavingDone(e,a){let i=this._translate.currentLang==="ar"?a?.arabicName:a?.englishName;this._translate.get(e?"GENERAL.ADDED_SUCCESSFULLY":"UPDATED_SUCCESSFULLY",{name:i}).subscribe(l=>this._toastr.success(l)),this._popup.close(!0)}close=()=>this._popup.close();onClassificationChange(e){this.tagForm.get("classificationId")?.setValue(e.value.id),this.tagForm.get("classification")?.setValue(e.value)}static \u0275fac=function(a){return new(a||t)(f(ni),f(z),f(P),f(k),f(K))};static \u0275cmp=y({type:t,selectors:[["admin-tags-form"]],standalone:!0,features:[L],decls:31,vars:41,consts:[["autocomplete","off",3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],["for","classificationIds"],["formControlName","classificationIds","optionLabel","name","optionValue","id","filterBy","name",3,"onChange","options","filter","showClear","placeholder"],["id","serviceType-error",1,"text-error"],[1,"field","col-12","md:col-6"],["for","englishName"],["pInputText","","type","text","pInputText","","formControlName","englishName",1,"w-full",3,"ngClass","placeholder"],["for","arabicName"],["type","text","pInputText","","formControlName","arabicName",1,"w-full",3,"ngClass","placeholder"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","label"]],template:function(a,i){a&1&&(s(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),m(4),o(5,"translate"),r(),s(6,"p-multiSelect",4),o(7,"translate"),_("onChange",function(d){return i.onClassificationChange(d)}),r(),g(8,aa,4,8,"small",5),r(),s(9,"div",6)(10,"label",7),m(11),o(12,"translate"),r(),S(13,"input",8),o(14,"translate"),g(15,na,4,8,"small",5)(16,ra,3,5,"small",5),r(),s(17,"div",6)(18,"label",9),m(19),o(20,"translate"),r(),S(21,"input",10),o(22,"translate"),g(23,oa,4,8,"small",5)(24,sa,3,5,"small",5),r()()(),s(25,"div",11)(26,"p-button",12),o(27,"translate"),_("onClick",function(){return i.close()}),r(),s(28,"p-button",13),o(29,"translate"),o(30,"translate"),_("onClick",function(){return i.save()}),r()()),a&2&&(p("formGroup",i.tagForm),n(4),b(c(5,19,"FIELDS.CLASSIFICATIONS")),n(2),p("options",i.classifications)("filter",!0)("showClear",!0)("placeholder",c(7,21,"FIELDS.CLASSIFICATIONS")),n(2),M(i.formError.hasSpecificError("classificationIds","required")?8:-1),n(3),b(c(12,23,"FIELDS.ENGLISH_NAME")),n(2),p("ngClass",I(37,zi,i.formError.hasError("englishName")))("placeholder",c(14,25,"FIELDS.ENGLISH_NAME")),n(2),M(i.formError.hasSpecificError("englishName","required")?15:-1),n(),M(i.formError.hasSpecificError("englishName","maxlength")?16:-1),n(3),b(c(20,27,"FIELDS.ARABIC_NAME")),n(2),p("ngClass",I(39,zi,i.formError.hasError("arabicName")))("placeholder",c(22,29,"FIELDS.ARABIC_NAME")),n(2),M(i.formError.hasSpecificError("arabicName","required")?23:-1),n(),M(i.formError.hasSpecificError("arabicName","maxlength")?24:-1),n(2),p("label",c(27,31,"GENERAL.CANCEL")),n(2),p("label",i.tag.id?c(29,33,"GENERAL.UPDATE"):c(30,35,"GENERAL.SAVE")))},dependencies:[V,Fe,ee,Ve,Q,W,Y,Z,J,O,j,ae,se,ge,H,ie,x,R],encapsulation:2})}return t})();var bi={columns:[{field:"tagName",header:"TAGNAME",type:"label",exported:!1},{field:"classifications",header:"CLASSIFICATION",type:"label",exported:!1},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",actions:["CREATE"],rowsActions:["EDIT","DELETE"],dataLoading:"server",paginator:!0,globalFilterFields:["tagName","classifications"],locale:"FIELDS.",hasFilters:!0};function la(t,u){if(t&1&&(s(0,"div",6)(1,"div"),m(2),r()()),t&2){let e=u.$implicit;n(2),b(e.name)}}var Rs=(()=>{class t{tagService;confirmService;translateService;popupService;toastrService;destroy$=new G;tableConfig$;searchControl=new pe;classifications=[];currentPage=1;totalRecords=0;first=0;pageSize=10;rows=10;selectedClassification=null;filters={number:1,size:10};constructor(e,a,i,l,d){this.tagService=e,this.confirmService=a,this.translateService=i,this.popupService=l,this.toastrService=d}ngOnInit(){this.getTags(this.filters),this.getClassifications()}getTags(e){this.tagService.getAllTags(e).pipe(Ie(a=>T(N({},bi),{rows:a.data.result.map(i=>T(N({},i),{classifications:(i.classifications||[]).map(l=>l.name).join(", ")}))||[],totalRecords:a.data.rowCount}))).subscribe({next:a=>this.tableConfig$=be(a)})}onActionClicked(e){switch(e.action){case"CREATE":this.createTags();break;case"EDIT":this.editTags(e.data);break;case"DELETE":this.deleteTags(e.data);break}}createTags(){this.popupService.open(vi,{title:this.translateService.instant("TAGS.ADD_NEW_TAG"),position:this.translateService.currentLang==="ar"?"left":"right"}).afterClosed.subscribe(e=>{e&&this.getTags(this.filters)})}editTags(e){this.popupService.open(vi,{title:this.translateService.instant("Tags.EDIT_TAG"),position:this.translateService.currentLang==="ar"?"left":"right",data:e}).afterClosed.subscribe(a=>{a&&this.getTags(this.filters)})}deleteTags(e){e.tagId&&this.confirmService.confirm("delete").subscribe(a=>{a&&this.tagService.deleteTags(e.tagId).pipe(v(this.destroy$)).subscribe(i=>{i.data&&(this.toastrService.success("Tag deleted successfully"),this.getTags({size:this.rows,number:this.currentPage}))})})}getClassifications(){this.tagService.getClassifications().pipe(v(this.destroy$)).subscribe(e=>{this.classifications=e.data.classifications})}onClassificationChange(e){this.selectedClassification=e.value,this.filterWithClassifications()}filterWithClassifications(){this.selectedClassification?this.tagService.getAllTags({size:this.rows,number:this.currentPage}).pipe(v(this.destroy$)).subscribe(e=>{let a=e.data.result.filter(i=>i.classifications?.some(l=>l.id===this.selectedClassification?.id)??!1);this.tableConfig$=be(T(N({},bi),{rows:a.map(i=>T(N({},i),{classifications:(i.classifications||[]).map(l=>l.name).join(", ")}))||[],totalRecords:a.length}))}):this.getTags({size:this.rows,number:this.currentPage})}onPageChange(e){this.first=e.first||0,this.rows=e.rows||10,this.currentPage=e.page||1,this.getTags({size:this.rows,number:this.currentPage})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(f(ni),f(re),f(P),f(z),f(k))};static \u0275cmp=y({type:t,selectors:[["admin-tags"]],standalone:!0,features:[L],decls:9,vars:9,consts:[[3,"actionClicked","onSearch","onPage","config"],["filters-area","",1,"filters","p-grid"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["formControlName","classification","optionLabel","name","filterBy","name","placeholder","Select a classifications",1,"w-full",3,"onChange","options","filter","showClear"],["pTemplate","selectedItem"],[1,"flex","align-items-center","gap-2"]],template:function(a,i){a&1&&(s(0,"shared-ui-table",0),o(1,"async"),_("actionClicked",function(d){return i.onActionClicked(d)})("onSearch",function(d){return i.searchControl.patchValue(d)})("onPage",function(d){return i.onPageChange(d)}),s(2,"div",1)(3,"div",2),m(4),o(5,"translate"),r(),s(6,"div",3)(7,"p-dropdown",4),_("onChange",function(d){return i.onClassificationChange(d)}),g(8,la,3,1,"ng-template",5),r()()()()),a&2&&(p("config",c(1,5,i.tableConfig$)),n(4),b(c(5,7,"GENERAL.FILTERS")),n(3),p("options",i.classifications)("filter",!0)("showClear",!0))},dependencies:[V,ye,ne,j,O,te,X,se,oe,x,R],encapsulation:2})}return t})();export{qa as a,Vn as b,Dr as c,_o as d,Qo as e,Rs as f};
