import{a as Fi,b as qe,c as Le}from"./chunk-5PW37T6R.js";import{b as He}from"./chunk-TJQN6HPD.js";import{a as Di,b as ce}from"./chunk-3M6H5IUW.js";import{a as Ce,b as oe}from"./chunk-5PJ2XD53.js";import{a as De,b as ye,e as Y,g as Ti,k as ne,m as M,n as Ni,o as re}from"./chunk-QRYLWIJ3.js";import{c as Ne,d as x,f as je}from"./chunk-KUFQSREL.js";import{m as te,n as j,q as Ii,r as Ai}from"./chunk-2BHT76TF.js";import{b as W,c as b,e as z,f as Z,g as pe,h as Si,i as Fe,k as J,l as $e,m as ze,n as K,r as ee,s as _e,t as H,w as ae,x as $}from"./chunk-HPGERUHF.js";import{f as ie,g as q}from"./chunk-VNHB2M7P.js";import{a as X}from"./chunk-QEQCDFPQ.js";import{b as V,c as R,d as w}from"./chunk-TI22M3TN.js";import{i as bi,n as ge}from"./chunk-CVH3MUVM.js";import{$a as E,Ac as Ae,Cc as Oe,Dc as Te,Eb as m,Fb as v,Gb as _,Gc as he,Ia as Se,Ib as Pe,J as be,Jb as Ge,K as g,Kb as ke,Lb as vi,Lc as B,Ma as n,Mb as L,Na as u,Nb as N,O as Me,Ob as S,T as Ue,Xb as o,Y as D,Yb as c,Zb as C,bb as d,eb as Ei,f as F,ga as G,ha as k,hb as P,j as fe,lb as s,mb as r,n as me,nb as T,ob as ei,pb as ii,rb as O,tb as h,ub as y,v as Ee,y as ve,yb as Ie}from"./chunk-FUWWX4DR.js";import{a as I,b as A}from"./chunk-4CLCTAJ7.js";var yi={columns:[{field:"id",header:"ID",type:"label",exported:!1},{field:"name",header:"CLASSIFICATION",type:"label",exported:!1},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",locale:"FIELDS.",actions:["CREATE"],rowsActions:["EDIT","DELETE"],dataLoading:"client",paginator:!0,globalFilterFields:["name"]};var ti=function(t){return t[t.NoService=0]="NoService",t[t.Maintenance=1]="Maintenance",t[t.Pets=2]="Pets",t}(ti||{});var ai=t=>({"ng-dirty ng-invalid":t}),ni=t=>({fieldName:t}),ri=()=>({maxLength:50});function ji(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,ni,c(2,1,"FIELDS.SERVICE_TYPE")))," "))}function $i(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,ni,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function zi(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,ri))," "))}function Hi(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,ni,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function qi(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,ri))," "))}function Xi(t,f){if(t&1){let e=O();s(0,"div",11),T(1,"img",15),s(2,"img",16),h("click",function(){G(e);let i=y();return k(i.removeFile())}),r()()}if(t&2){let e=y();n(),d("src",e.classification.icon==null?null:e.classification.icon.blobUrI,Se)("alt",e.classification.icon==null?null:e.classification.icon.id)}}function Yi(t,f){if(t&1){let e=O();s(0,"label",17),m(1,"Classification Icon"),r(),s(2,"p-fileUpload",18),h("onSelect",function(i){G(e);let l=y();return k(l.uploadFile(i))}),r()}t&2&&(n(2),d("showUploadButton",!1)("showCancelButton",!1)("maxFileSize",1e6))}function Qi(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.FIELD_REQUIRED",N(4,ri))," "))}var oi=(()=>{class t{_classifications;_popup;_translate;_toastr;_fb;destroy$=new F;formError;classificationsForm;classification;serviceTypes;constructor(e,a,i,l,p){this._classifications=e,this._popup=a,this._translate=i,this._toastr=l,this._fb=p}ngOnInit(){this.classification=this._popup.getData(),this.serviceTypes=Di.getEnumOptions(ti),this.classificationsForm=this.initForm(),this.formError=new Ne.ErrorManagement(this.classificationsForm),this.classification.id&&this.getClassificationDetails()}getClassificationDetails(){this._classifications.getClassificationById(this.classification.id).pipe(g(this.destroy$)).subscribe(e=>{this.classification=e.data,this.classification.id&&this.patchFormData()})}initForm(){return this._fb.group({id:[0],arabicName:["",[b.required,b.maxLength(50)]],englishName:["",[b.required,b.maxLength(50)]],serviceType:[null,[b.required]],icon:this._fb.group({id:0,externalStorageId:"",mimeType:"",has360View:!1,sizeInBytes:0,blobUrI:""})})}patchFormData(){this.classificationsForm.patchValue({id:this.classification.id,arabicName:this.classification.arabicName,englishName:this.classification.englishName,serviceType:this.classification.serviceType,icon:this.classification.icon});let e=this.classificationsForm.get("icon");this.classification.icon&&e.patchValue({id:this.classification.icon.id,externalStorageId:this.classification.icon.externalStorageId,mimeType:this.classification.icon.mimeType,has360View:this.classification.icon.has360View,sizeInBytes:this.classification.icon.sizeInBytes,blobUrI:this.classification.icon.blobUrI})}uploadFile(e){let a=e.files;if(a.length>0){let i=a[0];this.classificationsForm.get("icon").patchValue({id:0,externalStorageId:i.name,mimeType:i.type,sizeInBytes:i.size,has360View:!0,blobUrl:URL.createObjectURL(i)})}}removeFile(){this.classificationsForm.get("icon")?.get("blobUrI")?.setValue(""),this.classification.icon&&(this.classification.icon.blobUrI=void 0)}save(){let e=this.classificationsForm.getRawValue();(e.id?this._classifications.editClassification(e):this._classifications.addClassification(e)).pipe(g(this.destroy$)).subscribe(()=>this.afterSavingDone(e.id?"edit":"add",e))}afterSavingDone(e,a){let i=this._translate.currentLang==="ar"?a?.arabicName:a?.englishName;this._translate.get(e?"GENERAL.ADDED_SUCCESSFULLY":"UPDATED_SUCCESSFULLY",{name:i}).subscribe(l=>this._toastr.success(l)),this._popup.close(!0)}close=()=>this._popup.close();static \u0275fac=function(a){return new(a||t)(u(qe),u(M),u(V),u(x),u(ee))};static \u0275cmp=D({type:t,selectors:[["admin-classification-form"]],standalone:!0,features:[L],decls:35,vars:47,consts:[["autocomplete","off",3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],["for","serviceType"],["formControlName","serviceType","optionLabel","label","optionValue","value","filterBy","label",1,"w-full",3,"options","ngClass","filter","showClear","placeholder"],["id","serviceType-error",1,"text-error"],[1,"field","col-12","md:col-6"],["for","englishName"],["pInputText","","type","text","pInputText","","formControlName","englishName",1,"w-full",3,"ngClass","placeholder"],["for","arabicName"],["type","text","pInputText","","formControlName","arabicName",1,"w-full",3,"ngClass","placeholder"],[1,"container-img"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","disabled","label"],[3,"src","alt"],["src","assets/layout/images/close-icon.svg","alt","close-icon",1,"close",3,"click"],["for","icon"],["name","icon","id","icon","invalidFileTypeMessageSummary","Invalid Type","invalidFileLimitMessageDetail","Invalid Type","accept","image/*",3,"onSelect","showUploadButton","showCancelButton","maxFileSize"]],template:function(a,i){a&1&&(s(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),m(4),o(5,"translate"),r(),T(6,"p-dropdown",4),o(7,"translate"),E(8,ji,4,8,"small",5),r(),s(9,"div",6)(10,"label",7),m(11),o(12,"translate"),r(),T(13,"input",8),o(14,"translate"),E(15,$i,4,8,"small",5)(16,zi,3,5,"small",5),r(),s(17,"div",6)(18,"label",9),m(19),o(20,"translate"),r(),T(21,"input",10),o(22,"translate"),E(23,Hi,4,8,"small",5)(24,qi,3,5,"small",5),r(),s(25,"div",2),E(26,Xi,3,2,"div",11)(27,Yi,3,3)(28,Qi,3,5,"small",5),r()()(),s(29,"div",12)(30,"p-button",13),o(31,"translate"),h("onClick",function(){return i.close()}),r(),s(32,"p-button",14),o(33,"translate"),o(34,"translate"),h("onClick",function(){return i.save()}),r()()),a&2&&(d("formGroup",i.classificationsForm),n(4),v(c(5,23,"FIELDS.SERVICE_TYPE")),n(2),d("options",i.serviceTypes)("ngClass",S(41,ai,i.formError.hasError("serviceType")))("filter",!0)("showClear",!0)("placeholder",c(7,25,"FIELDS.SERVICE_TYPE")),n(2),P(i.formError.hasSpecificError("serviceType","required")?8:-1),n(3),v(c(12,27,"FIELDS.ENGLISH_NAME")),n(2),d("ngClass",S(43,ai,i.formError.hasError("englishName")))("placeholder",c(14,29,"FIELDS.ENGLISH_NAME")),n(2),P(i.formError.hasSpecificError("englishName","required")?15:-1),n(),P(i.formError.hasSpecificError("englishName","maxlength")?16:-1),n(3),v(c(20,31,"FIELDS.ARABIC_NAME")),n(2),d("ngClass",S(45,ai,i.formError.hasError("arabicName")))("placeholder",c(22,33,"FIELDS.ARABIC_NAME")),n(2),P(i.formError.hasSpecificError("arabicName","required")?23:-1),n(),P(i.formError.hasSpecificError("arabicName","maxlength")?24:-1),n(2),P(i.classification.icon!=null&&i.classification.icon.blobUrI?26:27),n(2),P(i.formError.hasSpecificError("icon","required")?28:-1),n(2),d("label",c(31,35,"GENERAL.CANCEL")),n(2),d("disabled",i.classificationsForm.invalid)("label",i.classification.id?c(33,37,"GENERAL.UPDATE"):c(34,39,"GENERAL.SAVE")))},dependencies:[B,Ae,H,Fe,W,z,Z,J,K,j,te,$,ae,ye,De,ie,q,w,R],styles:[".container-img[_ngcontent-%COMP%]{width:160px;height:124px;border:2px solid #ff7f3e;border-radius:8px;overflow:hidden;position:relative}.container-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.container-img[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:4px;inset-inline-end:4px;cursor:pointer;height:20px;width:20px;background:#ff7f3e;padding:5px;border-radius:50%}"]})}return t})();var Ia=(()=>{class t{_classifications;_confirm;_translate;_popup;_toast;destroy$=new F;tableConfig$;filters={number:1,size:10};constructor(e,a,i,l,p){this._classifications=e,this._confirm=a,this._translate=i,this._popup=l,this._toast=p}ngOnInit(){this.getAllClassifications(this.filters)}onActionClicked(e){switch(e.action){case"CREATE":this.createClassification();break;case"EDIT":this.editClassification(e.data);break;case"DELETE":this.deleteClassification(e.data);break}}getAllClassifications(e){this.tableConfig$=this._classifications.getAllClassifications(e).pipe(me(a=>A(I({},yi),{rows:a.data?.classifications,totalRecords:a.data.rowCount})))}createClassification(){this._popup.open(oi,{title:this._translate.instant("CLASSIFICATIONS.ADD_NEW_CLASSIFICATION"),position:this._translate.currentLang==="ar"?"left":"right"}).afterClosed.subscribe(e=>e&&this.getAllClassifications(this.filters))}editClassification(e){this._popup.open(oi,{title:this._translate.instant("CLASSIFICATIONS.EDIT_CLASSIFICATION"),position:this._translate.currentLang==="ar"?"left":"right",data:e}).afterClosed.subscribe(a=>a&&this.getAllClassifications(this.filters))}deleteClassification(e){e.id&&this._confirm.confirm("delete").subscribe(a=>{a&&this._classifications.deleteClassification(e.id).pipe(g(this.destroy$)).subscribe(()=>{this._toast.success(this._translate.instant("CLASSIFICATIONS.DELETE_CLASSIFICATION_SUCCESS")),this.getAllClassifications(this.filters)})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(u(qe),u(ne),u(V),u(M),u(x))};static \u0275cmp=D({type:t,selectors:[["admin-classifications"]],standalone:!0,features:[L],decls:2,vars:3,consts:[[3,"actionClicked","config"]],template:function(a,i){a&1&&(s(0,"shared-ui-table",0),o(1,"async"),h("actionClicked",function(p){return i.onActionClicked(p)}),r()),a&2&&d("config",c(1,1,i.tableConfig$))},dependencies:[B,he,Y,re,w],encapsulation:2})}return t})();var Ye=t=>({fieldName:t}),pi=()=>({maxLength:50});function Wi(t,f){t&1&&(s(0,"div",17),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,Ye,c(2,1,"FIELDS.CLASSIFICATION")))," "))}function Zi(t,f){t&1&&(s(0,"div",17),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,Ye,c(2,1,"FIELDS.BAR_CODE_NO")))," "))}function Ji(t,f){t&1&&(s(0,"div",17),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,pi))," "))}function Ki(t,f){t&1&&(s(0,"div",17),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,Ye,c(2,1,"FIELDS.SHORT_ARABIC_NAME")))," "))}function et(t,f){t&1&&(s(0,"div",17),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,pi))," "))}function it(t,f){t&1&&(s(0,"div",17),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,Ye,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function tt(t,f){t&1&&(s(0,"div",17),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,pi))," "))}function at(t,f){if(t&1){let e=O();ei(0),s(1,"p-fileUpload",18),o(2,"translate"),h("onSelect",function(i){G(e);let l=y();return k(l.onFileSelect(i))}),r(),ii()}t&2&&(n(),d("chooseLabel",c(2,1,"GENERAL.CHOOSE")))}function nt(t,f){if(t&1){let e=O();ei(0),s(1,"div",19),T(2,"img",20),s(3,"img",21),h("click",function(){G(e);let i=y();return k(i.removeImage())}),r()(),ii()}if(t&2){let e=y();n(2),d("src",e.data==null||e.data.response==null||e.data.response.icon==null?null:e.data.response.icon.blobUrI,Se)("alt",e.data==null||e.data.response==null||e.data.response.icon==null?null:e.data.response.icon.id)}}var ci=(()=>{class t{_fb;_popup;_translate;_toastr;_product;destroy$=new F;classifications=[];data;dialogForm;constructor(e,a,i,l,p){this._fb=e,this._popup=a,this._translate=i,this._toastr=l,this._product=p}ngOnInit(){this.prepareForm(),this.data=this._popup.getData(),this.classifications=this.data?.classifications,console.log("data?.response",this.data?.response),this.data?.response&&(this.dialogForm.patchValue(this.data?.response),this.setPreSelectedValues())}prepareForm(){this.dialogForm=this._fb.group({arabicName:[null,[b.required,b.maxLength(50)]],englishName:[null,[b.required,b.maxLength(50)]],classificationsIds:[null],classifications:[null,b.required],barcodeNumber:[null,b.required],icon:this._fb.group({externalStorageId:"",mimeType:"",sizeInBytes:0,blobUrI:""})})}get control(){return this.dialogForm.controls}onClassificationChange(e){let a=e.value.map(i=>i.id);this.dialogForm.get("classificationsIds")?.setValue(a),this.dialogForm.get("classifications")?.setValue(e.value)}setPreSelectedValues(){let e=this.data?.classifications.map(i=>this.classifications.find(l=>l.id===i.id)),a=e?.map(i=>i?.id);this.dialogForm.get("classificationsIds")?.setValue(a),this.dialogForm.patchValue({classifications:e})}save(){let e=this.dialogForm.getRawValue();(this.data?.response?this._product.editCategory(e):this._product.addCategory(e)).pipe(g(this.destroy$)).subscribe(()=>this.afterSavingDone(this.data?.response?"edit":"add",e))}afterSavingDone(e,a){let i=this._translate.currentLang==="ar"?a?.arabicName:a?.englishName;this._translate.get(e=="add"?"GENERAL.ADDED_SUCCESSFULLY":"GENERAL.UPDATED_SUCCESSFULLY",{name:i}).subscribe(l=>this._toastr.success(l)),this._popup.close(!0)}removeImage(){this.data&&this.data.icon&&(this.data.icon.blobUrI=void 0)}onFileSelect(e){if(e.files&&e.files[0]){let a=e.files[0];this.uploadImage(a).subscribe(i=>{this.updateFormWithResponse(i.data)},i=>{console.error("Error during image upload:",i)})}}uploadImage(e){let a=new FormData;return a.append("file",e),this._product.uploadGalaryImage(a)}updateFormWithResponse(e){this.dialogForm.get("icon")?.setValue({externalStorageId:e.externalStorageId,mimeType:e.mimeType,sizeInBytes:e.sizeInBytes,blobUrI:e.blobUrI})}close=()=>this._popup.close();static \u0275fac=function(a){return new(a||t)(u(ee),u(M),u(V),u(x),u(ce))};static \u0275cmp=D({type:t,selectors:[["admin-add-edit-category"]],standalone:!0,features:[vi([bi]),L],decls:43,vars:45,consts:[[1,"form-content",3,"formGroup"],[1,"row"],[1,"col-6"],["for","classification",1,"mb-2","block"],["formControlName","classifications","optionLabel","name",3,"onChange","options","placeholder"],["class","error-message",4,"ngIf"],["for","barcodeNumber",1,"mb-2","block"],["mode","decimal","inputId","withoutgrouping","formControlName","barcodeNumber",1,"w-full",3,"useGrouping","placeholder"],["for","arabicName",1,"mb-2","block"],["type","text","pInputText","","formControlName","arabicName",1,"w-full",3,"placeholder"],["for","englishName",1,"mb-2","block"],["type","text","pInputText","","formControlName","englishName",1,"w-full",3,"placeholder"],[1,"col-12"],[4,"ngIf"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","label","disabled"],[1,"error-message"],["mode","basic","chooseIcon","pi pi-upload","name","demo[]","accept","image/*","maxFileSize","1000000",3,"onSelect","chooseLabel"],[1,"container-img"],[3,"src","alt"],["src","assets/layout/images/close-icon.svg","alt","close-icon",1,"close",3,"click"]],template:function(a,i){a&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),m(4),o(5,"translate"),r(),s(6,"p-multiSelect",4),o(7,"translate"),h("onChange",function(p){return i.onClassificationChange(p)}),r(),E(8,Wi,4,8,"div",5),r(),s(9,"div",2)(10,"label",6),m(11),o(12,"translate"),r(),T(13,"p-inputNumber",7),o(14,"translate"),E(15,Zi,4,8,"div",5)(16,Ji,3,5,"div",5),r(),s(17,"div",2)(18,"label",8),m(19),o(20,"translate"),r(),T(21,"input",9),o(22,"translate"),E(23,Ki,4,8,"div",5)(24,et,3,5,"div",5),r(),s(25,"div",2)(26,"label",10),m(27),o(28,"translate"),r(),T(29,"input",11),o(30,"translate"),E(31,it,4,8,"div",5)(32,tt,3,5,"div",5),r(),s(33,"div",12),E(34,at,3,3,"ng-container",13)(35,nt,4,2,"ng-container",13),r(),s(36,"div",12)(37,"div",14)(38,"p-button",15),o(39,"translate"),h("onClick",function(){return i.close()}),r(),s(40,"p-button",16),o(41,"translate"),o(42,"translate"),h("onClick",function(){return i.save()}),r()()()()()),a&2&&(d("formGroup",i.dialogForm),n(4),v(c(5,23,"FIELDS.CLASSIFICATION")),n(2),d("options",i.classifications)("placeholder",c(7,25,"FIELDS.CLASSIFICATION")),n(2),d("ngIf",i.control.classifications.touched&&(i.control.classifications.errors==null?null:i.control.classifications.errors.required)),n(3),v(c(12,27,"FIELDS.BAR_CODE_NO")),n(2),d("useGrouping",!1)("placeholder",c(14,29,"FIELDS.BAR_CODE_NO")),n(2),d("ngIf",i.control.barcodeNumber.touched&&(i.control.barcodeNumber.errors==null?null:i.control.barcodeNumber.errors.required)),n(),d("ngIf",i.control.barcodeNumber.touched&&(i.control.barcodeNumber.errors==null?null:i.control.barcodeNumber.errors.maxlength)),n(3),v(c(20,31,"FIELDS.SHORT_ARABIC_NAME")),n(2),d("placeholder",c(22,33,"FIELDS.SHORT_ARABIC_NAME")),n(2),d("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.required)),n(),d("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.maxlength)),n(3),v(c(28,35,"FIELDS.ENGLISH_NAME")),n(2),d("placeholder",c(30,37,"FIELDS.ENGLISH_NAME")),n(2),d("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.required)),n(),d("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.maxlength)),n(2),d("ngIf",!(!(i.data==null||i.data.response==null||i.data.response.icon==null)&&i.data.response.icon.blobUrI)),n(),d("ngIf",i.data==null||i.data.response==null||i.data.response.icon==null?null:i.data.response.icon.blobUrI),n(3),d("label",c(39,39,"GENERAL.CANCEL")),n(2),d("label",i.data!=null&&i.data.response?c(41,41,"GENERAL.UPDATE"):c(42,43,"GENERAL.SAVE"))("disabled",i.dialogForm.invalid))},dependencies:[B,Te,_e,W,z,Z,ye,De,ie,oe,Ce,w,R,He,Ai,Ii,H,J,K,$,ae,q],styles:[".container-img[_ngcontent-%COMP%]{width:160px;height:124px;border:2px solid #ff7f3e;border-radius:8px;overflow:hidden;position:relative}.container-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.container-img[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;top:4px;inset-inline-end:4px;cursor:pointer;height:20px;width:20px;background:#ff7f3e;padding:5px;border-radius:50%}"]})}return t})();var Qe={columns:[{field:"name",header:"CATEGORY_NAME",type:"label",exported:!1},{field:"subCategories",header:"SUB_CATAGORY",type:"label",exported:!0},{field:"classification",header:"CLASSIFICATION",type:"label",exported:!0},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",actions:["CREATE"],rowsActions:["EDIT","DELETE"],paginator:!0,locale:"FIELDS.",dataLoading:"server"};function rt(t,f){if(t&1&&(s(0,"div",7)(1,"div"),m(2),r()()),t&2){let e=f.$implicit;n(2),v(e.name)}}var ln=(()=>{class t{_confirm;_product;_popup;_toaster;_translate;_unsubscribeAll=new F;classifications=[];tableConfig;displayDialog=!1;selectedClassification=null;pageSize=10;pageNumber=1;totalRecords=0;first=0;keyword="";searchControl=new pe;constructor(e,a,i,l,p){this._confirm=e,this._product=a,this._popup=i,this._toaster=l,this._translate=p}ngOnInit(){this.tableConfig=Qe,this.getAllCategories(),this.getClassifications(),this.onSearch()}getClassifications(){this._product.getClassifications().pipe(g(this._unsubscribeAll)).subscribe(e=>{this.classifications=e?.data?.classifications})}onActionClicked(e){switch(e.action){case"CREATE":this.openCreateDialog();break;case"EDIT":this.getCategoryById(e.data);break;case"DELETE":this.onActionDelete(e.data);break}}onActionDelete(e){this._confirm.confirm("delete").subscribe(a=>{a&&this._product.deleteCategory(e.id).pipe(g(this._unsubscribeAll)).subscribe(i=>{i.data&&(this._toaster.success(this._translate.instant("GENERAL.DELETED_SUCCESSFULLY",{name:this._translate.instant("CATEGORY.NAME")})),this.getAllCategories())})})}onClassificationChange(e){this.selectedClassification=e.value,this.filterCategories()}getAllCategories(){this._product.getAllCategories(this.pageSize,this.pageNumber,this.keyword).pipe(g(this._unsubscribeAll)).subscribe(e=>{this.tableConfig=A(I({},Qe),{rows:e.data.result.map(a=>A(I({},a),{classification:a?.classification.map(i=>i.name).join(", "),subCategories:a?.subCategories.map(i=>i.name).join(", ")}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT","DELETE"]})})}filterCategories(){this.selectedClassification?this._product.getAllCategories(this.pageSize,this.pageNumber,this.keyword).pipe(g(this._unsubscribeAll)).subscribe(e=>{let a=e.data.result.filter(i=>Array.isArray(i.classification)?i.classification.some(l=>l.id===this.selectedClassification?.id):i.classification?.id===this.selectedClassification?.id);this.tableConfig.rows=a.map(i=>A(I({},i),{classification:Array.isArray(i.classification)?i.classification.map(l=>l.name).join(", "):i.classification?.name,subCategories:i.subCategories.map(l=>l.name).join(", ")}))}):this.getAllCategories()}onPageChange(e){this.first=e.first||0,this.pageSize=e.rows||10,this.pageNumber=e.page||1,this.getAllCategories()}onDialogClose(){this.displayDialog=!1}onSearch(){this.searchControl.valueChanges.pipe(Ee(e=>e.trim().length>=0),ve(400),be(e=>this._product.getAllCategories(this.pageSize,this.pageNumber,e.trim()))).subscribe(e=>{e&&e.data&&(this.tableConfig=A(I({},Qe),{rows:e.data.result.map(a=>A(I({},a),{classification:a.classification.map(i=>i.name).join(", "),subCategories:a.subCategories.map(i=>i.name).join(", ")}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT","DELETE"]}))})}openCreateDialog(){this._popup.open(ci,{title:this._translate.instant("CATEGORY.ADD_NEW_CATEGORY"),position:this._translate.currentLang==="ar"?"left":"right",data:{classifications:this.classifications}}).afterClosed.subscribe(e=>e&&this.getAllCategories())}getCategoryById(e){this._product.getCategoryById(Number(e.id)).subscribe(a=>{a.data&&this._popup.open(ci,{title:this._translate.instant("CATEGORY.EDIT_NEW_CATEGORY"),position:this._translate.currentLang==="ar"?"left":"right",data:{response:a.data,classifications:this.classifications}}).afterClosed.subscribe(i=>i&&this.getAllCategories())})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static \u0275fac=function(a){return new(a||t)(u(ne),u(ce),u(M),u(x),u(V))};static \u0275cmp=D({type:t,selectors:[["admin-categories"]],standalone:!0,features:[L],decls:10,vars:7,consts:[[1,"dialog-side"],[3,"actionClicked","onPage","onSearch","config"],["filters-area","",1,"filters","row"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["formControlName","classification","optionLabel","name","filterBy","name",1,"w-full",3,"onChange","options","filter","showClear","placeholder"],["pTemplate","selectedItem"],[1,"flex","align-items-center","gap-2"]],template:function(a,i){a&1&&(s(0,"section",0)(1,"shared-ui-table",1),h("actionClicked",function(p){return i.onActionClicked(p)})("onPage",function(p){return i.onPageChange(p)})("onSearch",function(p){return i.searchControl.patchValue(p)}),s(2,"div",2)(3,"div",3),m(4,"Filters"),r(),s(5,"div",4),m(6,"` "),s(7,"p-dropdown",5),o(8,"translate"),h("onChange",function(p){return i.onClassificationChange(p)}),E(9,rt,3,1,"ng-template",6),r()()()()()),a&2&&(n(),d("config",i.tableConfig),n(6),d("options",i.classifications)("filter",!0)("showClear",!0)("placeholder",c(8,5,"FIELDS.CLASSIFICATION")))},dependencies:[B,Y,j,te,ge,re,w,R],encapsulation:2})}return t})();var Bi={columns:[{field:"arabicName",header:"VARIANTNAME",type:"label",exported:!1},{field:"variantsValueProp",header:"VARIANTVALUE",type:"label",exported:!1},{field:"classification",header:"CLASSIFICATION",type:"label",exported:!1},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",actions:["CREATE"],rowsActions:["EDIT","DELETE","ADD_VARIANT_VALUE"],paginator:!0,locale:"FIELDS.",dataLoading:"server",hasFilters:!0};var Re=t=>({fieldName:t}),We=()=>({maxLength:50});function st(t,f){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,Re,c(2,1,"FIELDS.CLASSIFICATION")))," "))}function lt(t,f){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,Re,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function pt(t,f){t&1&&(s(0,"div",18),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,We))," "))}function ct(t,f){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,Re,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function dt(t,f){t&1&&(s(0,"div",18),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,We))," "))}function mt(t,f){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,Re,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function ut(t,f){t&1&&(s(0,"div",18),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,We))," "))}function ft(t,f){t&1&&(s(0,"div",18),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,Re,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function ht(t,f){t&1&&(s(0,"div",18),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,We))," "))}function gt(t,f){if(t&1){let e=O();s(0,"div",19)(1,"div",6)(2,"div",20)(3,"div",21)(4,"div",8)(5,"label",9),m(6),o(7,"translate"),r(),T(8,"input",22),o(9,"translate"),E(10,mt,4,8,"div",5)(11,ut,3,5,"div",5),r()(),s(12,"div",23)(13,"div",8)(14,"label",9),m(15),o(16,"translate"),r(),T(17,"input",24),o(18,"translate"),E(19,ft,4,8,"div",5)(20,ht,3,5,"div",5),r()(),s(21,"div",25)(22,"div",15)(23,"p-button",26),h("click",function(){G(e);let i=y();return k(i.addNewVariants())}),r(),s(24,"p-button",27),h("click",function(){let i=G(e).index,l=y();return k(l.removeVariants(i))}),r()()()()()()}if(t&2){let e,a,i,l,p=f.index,U=y();d("formGroupName",p),n(6),v(c(7,13,"FIELDS.ARABIC_NAME")),n(2),Ie("id","arabicName",p,""),d("placeholder",c(9,15,"FIELDS.ARABIC_NAME")),n(2),d("ngIf",((e=U.variantValues.at(p).get("arabicName"))==null?null:e.touched)&&((e=U.variantValues.at(p).get("arabicName"))==null?null:e.hasError("required"))),n(),d("ngIf",((a=U.variantValues.at(p).get("arabicName"))==null?null:a.touched)&&((a=U.variantValues.at(p).get("arabicName"))==null?null:a.hasError("maxlength"))),n(4),v(c(16,17,"FIELDS.ENGLISH_NAME")),n(2),Ie("id","englishName",p,""),d("placeholder",c(18,19,"FIELDS.ENGLISH_NAME")),n(2),d("ngIf",((i=U.variantValues.at(p).get("englishName"))==null?null:i.touched)&&((i=U.variantValues.at(p).get("englishName"))==null?null:i.hasError("required"))),n(),d("ngIf",((l=U.variantValues.at(p).get("englishName"))==null?null:l.touched)&&((l=U.variantValues.at(p).get("englishName"))==null?null:l.hasError("maxlength")))}}var mi=(()=>{class t{fb;_popup;_varaints;_translate;_toastr;_product;destroy$=new F;addVariantForm;classifications=[];breadcrumb;variantsData;constructor(e,a,i,l,p,U){this.fb=e,this._popup=a,this._varaints=i,this._translate=l,this._toastr=p,this._product=U}ngOnInit(){this.initForm(),this.getClassifications(),this.variantsData=this._popup.getData(),this.variantsData.id&&this.getVariantsDataDetails()}getClassifications(){this._product.getClassifications().pipe(g(this.destroy$)).subscribe(e=>{this.classifications=e.data.classifications})}getVariantsDataDetails(){this._varaints.getById(this.variantsData.id).pipe(g(this.destroy$)).subscribe(e=>{this.variantsData=e.data,this.variantsData.id&&this.setdataInform()})}initForm(){this.addVariantForm=this.fb.group({id:[0],arabicName:["",[b.required,b.maxLength(50)]],englishName:["",[b.required,b.maxLength(50)]],classificationIds:[[],b.required],variantValues:this.fb.array([this.createVariantGroup()])})}setdataInform(){if(this.variantsData){this.addVariantForm.patchValue(this.variantsData),this.variantValues.clear();for(let e=0;e<this.variantsData.variantValues.length;e++)this.variantValues.push(this.fb.group({id:this.variantsData.variantValues[e].id,englishName:this.variantsData.variantValues[e].englishName,arabicName:this.variantsData.variantValues[e].arabicName}))}}onClassificationChange(e){this.addVariantForm.get("classificationId")?.setValue(e.value.id),this.addVariantForm.get("classification")?.setValue(e.value)}get variantValues(){return this.addVariantForm.get("variantValues")}get control(){return this.addVariantForm.controls}createVariantGroup(){return this.fb.group({id:[0],arabicName:["",[b.required,b.maxLength(50)]],englishName:["",[b.required,b.maxLength(50)]]})}addNewVariants(){this.variantValues.push(this.createVariantGroup())}removeVariants(e){e&&this.variantValues.removeAt(e)}save(){let e=this.addVariantForm.getRawValue();(e.id?this._varaints.update(e):this._varaints.create(e)).pipe(g(this.destroy$)).subscribe(()=>this.afterSavingDone(e.id?"edit":"add",e))}afterSavingDone(e,a){let i=this._translate.currentLang==="ar"?a?.arabicName:a?.englishName;this._translate.get(e?"GENERAL.ADDED_SUCCESSFULLY":"UPDATED_SUCCESSFULLY",{name:i}).subscribe(l=>this._toastr.success(l)),this._popup.close(!0)}close=()=>this._popup.close();ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(u(ee),u(M),u(Le),u(V),u(x),u(ce))};static \u0275cmp=D({type:t,selectors:[["admin-add-edit-variants"]],standalone:!0,features:[L],decls:36,vars:37,consts:[[1,"p-fluid","formgrid",3,"formGroup"],[1,"p-grid","mb-1"],[1,"p-col-6"],["for","classificationIds"],["formControlName","classificationIds","optionLabel","name","optionValue","id","filterBy","name",3,"onChange","options","filter","showClear","placeholder"],["class","error-message",4,"ngIf"],[1,"grid"],[1,"field","col-6"],[1,"flex","flex-column","gap-2"],["for","arabicName"],["pInputText","","formControlName","arabicName","id","arabicName","aria-describedby","arabicName-help",3,"placeholder"],["for","englishName"],["pInputText","","formControlName","englishName","id","englishName","aria-describedby","englishName-help",3,"placeholder"],["formArrayName","variantValues"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","disabled","label"],[1,"error-message"],[3,"formGroupName"],[1,"flex","align-items-center"],[1,"field","col-5"],["pInputText","","formControlName","arabicName","aria-describedby","arabicName-help",3,"placeholder","id"],[1,"field","md:col-5"],["pInputText","","formControlName","englishName","aria-describedby","englishName-help",3,"placeholder","id"],[1,"field","col-2"],["severity","primary","icon","pi pi-plus",3,"click"],["severity","danger","icon","pi pi-minus",3,"click"]],template:function(a,i){a&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),m(4),o(5,"translate"),r(),s(6,"p-multiSelect",4),o(7,"translate"),h("onChange",function(p){return i.onClassificationChange(p)}),r(),E(8,st,4,8,"div",5),r()(),s(9,"div",6)(10,"div",7)(11,"div",8)(12,"label",9),m(13),o(14,"translate"),r(),T(15,"input",10),o(16,"translate"),E(17,lt,4,8,"div",5)(18,pt,3,5,"div",5),r()(),s(19,"div",7)(20,"div",8)(21,"label",11),m(22),o(23,"translate"),r(),T(24,"input",12),o(25,"translate"),E(26,ct,4,8,"div",5)(27,dt,3,5,"div",5),r()()(),s(28,"div",13),E(29,gt,25,21,"div",14),r(),s(30,"div",15)(31,"p-button",16),o(32,"translate"),h("onClick",function(){return i.close()}),r(),s(33,"p-button",17),o(34,"translate"),o(35,"translate"),h("onClick",function(){return i.save()}),r()()()),a&2&&(d("formGroup",i.addVariantForm),n(4),v(c(5,19,"FIELDS.CLASSIFICATION")),n(2),d("options",i.classifications)("filter",!0)("showClear",!0)("placeholder",c(7,21,"FIELDS.CLASSIFICATION")),n(2),d("ngIf",i.control.classificationIds.touched&&(i.control.classificationIds.errors==null?null:i.control.classificationIds.errors.required)),n(5),v(c(14,23,"FIELDS.ARABIC_NAME")),n(2),d("placeholder",c(16,25,"FIELDS.ARABIC_NAME")),n(2),d("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.required)),n(),d("ngIf",i.control.arabicName.touched&&(i.control.arabicName.errors==null?null:i.control.arabicName.errors.maxlength)),n(4),v(c(23,27,"FIELDS.ENGLISH_NAME")),n(2),d("placeholder",c(25,29,"FIELDS.ENGLISH_NAME")),n(2),d("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.required)),n(),d("ngIf",i.control.englishName.touched&&(i.control.englishName.errors==null?null:i.control.englishName.errors.maxlength)),n(2),d("ngForOf",i.variantValues.controls),n(2),d("label",c(32,31,"GENERAL.CANCEL")),n(2),d("disabled",i.addVariantForm.invalid)("label",i.variantsData.id?c(34,33,"GENERAL.UPDATE"):c(35,35,"GENERAL.SAVE")))},dependencies:[B,Oe,Te,_e,W,z,Z,H,J,K,$e,ze,$,ae,q,ie,w,R,oe,Ce,He]})}return t})();var xi=t=>({fieldName:t}),Vi=()=>({maxLength:50});function _t(t,f){t&1&&(s(0,"div",20),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,xi,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function Ct(t,f){t&1&&(s(0,"div",20),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,Vi))," "))}function Et(t,f){t&1&&(s(0,"div",20),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,xi,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function vt(t,f){t&1&&(s(0,"div",20),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,Vi))," "))}function bt(t,f){if(t&1){let e=O();s(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"label",11),m(6),o(7,"translate"),r(),T(8,"input",12),o(9,"translate"),E(10,_t,4,8,"div",13)(11,Ct,3,5,"div",13),r()(),s(12,"div",14)(13,"div",10)(14,"label",11),m(15),o(16,"translate"),r(),T(17,"input",15),o(18,"translate"),E(19,Et,4,8,"div",13)(20,vt,3,5,"div",13),r()(),s(21,"div",16)(22,"div",17)(23,"p-button",18),h("click",function(){G(e);let i=y();return k(i.addNewVariants())}),r(),s(24,"p-button",19),h("click",function(){let i=G(e).index,l=y();return k(l.removeVariants(i))}),r()()()()()()}if(t&2){let e,a,i,l,p=f.index,U=y();d("formGroupName",p),n(6),v(c(7,13,"FIELDS.ARABIC_NAME")),n(2),Ie("id","arabicName",p,""),d("placeholder",c(9,15,"FIELDS.ARABIC_NAME")),n(2),d("ngIf",((e=U.variantValues.at(p).get("arabicName"))==null?null:e.touched)&&((e=U.variantValues.at(p).get("arabicName"))==null?null:e.hasError("required"))),n(),d("ngIf",((a=U.variantValues.at(p).get("arabicName"))==null?null:a.touched)&&((a=U.variantValues.at(p).get("arabicName"))==null?null:a.hasError("maxlength"))),n(4),v(c(16,17,"FIELDS.ENGLISH_NAME")),n(2),Ie("id","englishName",p,""),d("placeholder",c(18,19,"FIELDS.ENGLISH_NAME")),n(2),d("ngIf",((i=U.variantValues.at(p).get("englishName"))==null?null:i.touched)&&((i=U.variantValues.at(p).get("englishName"))==null?null:i.hasError("required"))),n(),d("ngIf",((l=U.variantValues.at(p).get("englishName"))==null?null:l.touched)&&((l=U.variantValues.at(p).get("englishName"))==null?null:l.hasError("maxlength")))}}var wi=(()=>{class t{fb;_popup;_variants;_translate;_toastr;addVariantValueForm;destroy$=new F;variantsData;constructor(e,a,i,l,p){this.fb=e,this._popup=a,this._variants=i,this._translate=l,this._toastr=p}ngOnInit(){this.initForm(),this.variantsData=this._popup.getData()}initForm(){this.addVariantValueForm=this.fb.group({id:[0],variantValues:this.fb.array([this.createVariantGroup()])})}addNewVariants(){this.variantValues.push(this.createVariantGroup())}removeVariants(e){e&&this.variantValues.removeAt(e)}get variantValues(){return this.addVariantValueForm.get("variantValues")}createVariantGroup(){return this.fb.group({id:[0],arabicName:["",[b.required,b.maxLength(50)]],englishName:["",[b.required,b.maxLength(50)]]})}get control(){return this.addVariantValueForm.controls}save(){let e=this.addVariantValueForm.getRawValue();e.id=this.variantsData?.id,e.classificationIds&&(e.classificationIds=e.classificationIds.map(a=>a.id?a.id:a)),this._variants.create(e).pipe(g(this.destroy$)).subscribe(()=>this.afterSavingDone(this.variantsData))}afterSavingDone(e){let a=this._translate.currentLang==="ar"?e?.arabicName:e?.englishName;this._translate.get("GENERAL.ADDED_SUCCESSFULLY",{name:a}).subscribe(i=>this._toastr.success(i)),this._popup.close(!0)}close=()=>this._popup.close();ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(u(ee),u(M),u(Le),u(V),u(x))};static \u0275cmp=D({type:t,selectors:[["admin-add-variants-value"]],standalone:!0,features:[L],decls:8,vars:9,consts:[[1,"p-fluid","formgrid",3,"formGroup"],["formArrayName","variantValues"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","disabled","label"],[3,"formGroupName"],[1,"grid"],[1,"flex","align-items-center"],[1,"field","col-5"],[1,"flex","flex-column","gap-2"],["for","arabicName"],["pInputText","","formControlName","arabicName","aria-describedby","arabicName-help",3,"placeholder","id"],["class","error-message",4,"ngIf"],[1,"field","md:col-5"],["pInputText","","type","text","formControlName","englishName",3,"id","placeholder"],[1,"field","col-2"],[1,"flex","gap-2","mt-1","align-items-center","justify-content-end"],["severity","primary","icon","pi pi-plus",3,"click"],["severity","danger","icon","pi pi-minus",3,"click"],[1,"error-message"]],template:function(a,i){a&1&&(s(0,"div",0)(1,"div",1),E(2,bt,25,21,"div",2),r(),s(3,"div",3)(4,"p-button",4),o(5,"translate"),h("onClick",function(){return i.close()}),r(),s(6,"p-button",5),o(7,"translate"),h("onClick",function(){return i.save()}),r()()()),a&2&&(d("formGroup",i.addVariantValueForm),n(2),d("ngForOf",i.variantValues.controls),n(2),d("label",c(5,5,"GENERAL.CANCEL")),n(2),d("disabled",i.addVariantValueForm.invalid)("label",c(7,7,"GENERAL.SAVE")))},dependencies:[B,Oe,Te,_e,W,z,Z,H,J,K,$e,ze,q,ie,w,R,$,ae]})}return t})();var It=()=>[],nr=(()=>{class t{_confirm;_product;_variants;_popup;_toastr;_translate;destroy$=new F;classifications$;tableConfig$;searchControl=new pe;filters={PageNumber:1,PageSize:10,name:"",classification:null};constructor(e,a,i,l,p,U){this._confirm=e,this._product=a,this._variants=i,this._popup=l,this._toastr=p,this._translate=U}ngOnInit(){this.getClassifications(),this.getAllVariants(this.filters),this.onSearchData()}getClassifications(){this.classifications$=this._product.getClassifications().pipe(me(e=>e.data.classifications))}onSearchData(){this.searchControl.valueChanges.pipe(Ee(e=>e.trim().length>0),ve(400),be(e=>this._variants.getAll(this.filters=A(I({},this.filters),{name:e})))).subscribe(e=>{this.tableConfig$=fe(this.mappedVariants(e))})}onPageChange(e){this.filters=A(I({},this.filters),{PageSize:e.rows||10,PageNumber:e.page||1}),this.getAllVariants(this.filters)}getAllVariants(e){this.tableConfig$=this._variants.getAll(e).pipe(me(a=>this.mappedVariants(a)))}onActionClicked(e){switch(e.action){case"CREATE":this.createVariant();break;case"ADD_VARIANT_VALUE":e.data&&this.createVariantValues(e.data);break;case"DELETE":e.data&&this.deleteVariant(e.data);break;case"EDIT":e.data&&this.editVariant(e.data);break;default:break}}createVariant(){this._popup.open(mi,{title:this._translate.instant("VARIANTS.ADD_NEW_VARIANT"),position:this._translate.currentLang==="ar"?"left":"right"}).afterClosed.subscribe(e=>e&&this.getAllVariants(this.filters))}createVariantValues(e){this._popup.open(wi,{title:this._translate.instant("VARIANTS.ADD_NEW_VARIANT"),position:this._translate.currentLang==="ar"?"left":"right",data:e}).afterClosed.subscribe(a=>a&&this.getAllVariants(this.filters))}editVariant(e){this._popup.open(mi,{title:this._translate.instant("VARIANTS.EDIT_VARIANT"),position:this._translate.currentLang==="ar"?"left":"right",data:e}).afterClosed.subscribe(a=>a&&this.getAllVariants(this.filters))}deleteVariant(e){this._confirm.confirm("delete").subscribe(a=>{a&&this._variants.delete(e.id).pipe(g(this.destroy$)).subscribe(i=>{i.data&&(this._toastr.success("Variant Deleted Successfully"),this.getAllVariants(this.filters))})})}mappedVariants(e){return console.log("API Response:",e),A(I({},Bi),{totalRecords:e.data.rowCount,rowsPerPage:this.filters.PageSize,rows:e.data.result.map(a=>A(I({},a),{classification:a.classificationIds.map(i=>i.name).join(", "),variantsValueProp:a.variantValues.map(i=>i.name).join(", ")}))||[]})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(u(ne),u(ce),u(Le),u(M),u(x),u(V))};static \u0275cmp=D({type:t,selectors:[["admin-variants"]],standalone:!0,features:[L],decls:9,vars:13,consts:[[3,"actionClicked","onPage","onSearch","config"],["filters-area","",1,"filters","p-grid"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["optionLabel","name","filterBy","name","placeholder","Select a classifications",1,"w-full",3,"ngModelChange","onChange","options","ngModel","filter","showClear"]],template:function(a,i){a&1&&(s(0,"shared-ui-table",0),o(1,"async"),h("actionClicked",function(p){return i.onActionClicked(p)})("onPage",function(p){return i.onPageChange(p)})("onSearch",function(p){return i.searchControl.patchValue(p)}),s(2,"div",1)(3,"div",2),m(4),o(5,"translate"),r(),s(6,"div",3)(7,"p-dropdown",4),o(8,"async"),ke("ngModelChange",function(p){return Ge(i.filters.classification,p)||(i.filters.classification=p),p}),h("onChange",function(){return i.getAllVariants(i.filters)}),r()()()()),a&2&&(d("config",c(1,6,i.tableConfig$)),n(4),v(c(5,8,"GENERAL.FILTERS")),n(3),d("options",c(8,10,i.classifications$)||N(12,It)),Pe("ngModel",i.filters.classification),d("filter",!0)("showClear",!0))},dependencies:[B,he,j,te,re,q,Y,w,R,_e,z,Si,H],encapsulation:2})}return t})();var Ze=(()=>{class t{_http;constructor(e){this._http=e}getClassifications(){return this._http.get(`${X.URL_API}Classifications`)}getBrands(e){return this._http.get(`${X.URL_API}Brands?PageSize=${e.size}&PageNumber=${e.number}`)}addBrand(e){return this._http.post(`${X.URL_API}Brands`,e)}deleteBrand(e){return this._http.delete(`${X.URL_API}Brands/${e}`)}editBrand(e){return this._http.put(`${X.URL_API}Brands`,e)}getBrandById(e){return this._http.get(`${X.URL_API}Brands/${e}`)}static \u0275fac=function(a){return new(a||t)(Ue(je))};static \u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Mi=t=>({"ng-dirty ng-invalid":t}),ui=t=>({fieldName:t}),Ui=()=>({maxLength:50});function Tt(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,ui,c(2,1,"FIELDS.classificationIds")))," "))}function Nt(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,ui,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function Ft(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,Ui))," "))}function Dt(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,ui,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function yt(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,Ui))," "))}function Lt(t,f){if(t&1){let e=O();s(0,"div",11),T(1,"img",15),s(2,"img",16),h("click",function(){G(e);let i=y();return k(i.removeFile())}),r()()}if(t&2){let e=y();n(),d("src",e.brand.icon==null?null:e.brand.icon.blobUrI,Se)("alt",e.brand.icon==null?null:e.brand.icon.id)}}function Bt(t,f){if(t&1){let e=O();s(0,"label",17),m(1,"Brand Icon"),r(),s(2,"p-fileUpload",18),h("onSelect",function(i){G(e);let l=y();return k(l.uploadFile(i))}),r()}t&2&&(n(2),d("showUploadButton",!1)("showCancelButton",!1)("maxFileSize",1e6))}var fi=(()=>{class t{_product;_popup;_translate;_toastr;_fb;destroy$=new F;formError;brandForm;brand;selectedBrands;classifications=[];constructor(e,a,i,l,p){this._product=e,this._popup=a,this._translate=i,this._toastr=l,this._fb=p}ngOnInit(){this.brand=this._popup.getData(),this.brandForm=this.initForm(),this.formError=new Ne.ErrorManagement(this.brandForm),this.brand.id&&this.getBrandDetails(),this.getClassifications()}getBrandDetails(){this._product.getBrandById(this.brand.id).pipe(g(this.destroy$)).subscribe({next:e=>{this.brand=e.data,this.selectedBrands||(this.selectedBrands={classificationModels:[],classificationIds:[]}),this.selectedBrands.classificationIds=(this.brand.classificationModels||[]).map(a=>a.id||0),this.brand.id&&this.patchFormData()}})}initForm(){return this._fb.group({id:[0],classificationIds:[[],[b.required]],arabicName:["",[b.required]],englishName:["",[b.required]],serviceType:[null,[b.required]],icon:this._fb.group({id:0,externalStorageId:"",mimeType:"",has360View:!1,sizeInBytes:0,blobUrI:""})})}patchFormData(){this.brandForm.patchValue({id:this.brand.id,classificationIds:this.selectedBrands.classificationIds||[],arabicName:this.brand.arabicName,englishName:this.brand.englishName,icon:this.brand.icon||{}}),console.log("Form Value Inside patchFormData:",this.brandForm.value);let e=this.brandForm.get("icon");this.brand.icon&&e.patchValue({id:this.brand.icon.id,externalStorageId:this.brand.icon.externalStorageId,mimeType:this.brand.icon.mimeType,has360View:this.brand.icon.has360View,sizeInBytes:this.brand.icon.sizeInBytes,blobUrI:this.brand.icon.blobUrI})}uploadFile(e){let a=e.files;if(a.length>0){let i=a[0];this.brandForm.get("icon").patchValue({id:0,externalStorageId:i.name,mimeType:i.type,sizeInBytes:i.size,has360View:!0,blobUrl:URL.createObjectURL(i)})}}removeFile(){this.brandForm.get("icon")?.get("blobUrI")?.setValue(""),this.brand.icon&&(this.brand.icon.blobUrI=void 0)}save(){let e=this.brandForm.getRawValue();(e.id?this._product.editBrand(e):this._product.addBrand(e)).pipe(g(this.destroy$)).subscribe(()=>this.afterSavingDone(e.id?"edit":"add",e))}afterSavingDone(e,a){let i=this._translate.currentLang==="ar"?a?.arabicName:a?.englishName;this._translate.get(e?"GENERAL.ADDED_SUCCESSFULLY":"UPDATED_SUCCESSFULLY",{name:i}).subscribe(l=>this._toastr.success(l)),this._popup.close(!0)}close=()=>this._popup.close();onClassificationChange(e){this.brandForm.get("classificationId")?.setValue(e.value.id),this.brandForm.get("classification")?.setValue(e.value)}getClassifications(){this._product.getClassifications().pipe(g(this.destroy$)).subscribe({next:e=>{this.classifications=e.data.classifications}})}static \u0275fac=function(a){return new(a||t)(u(Ze),u(M),u(V),u(x),u(ee))};static \u0275cmp=D({type:t,selectors:[["admin-brands-form"]],standalone:!0,features:[L],decls:34,vars:42,consts:[["autocomplete","off",3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],["for","classificationIds"],["formControlName","classificationIds","optionLabel","name","optionValue","id","filterBy","name",3,"onChange","options","filter","showClear","placeholder"],["id","serviceType-error",1,"text-error"],[1,"field","col-12","md:col-6"],["for","englishName"],["pInputText","","type","text","pInputText","","formControlName","englishName",1,"w-full",3,"ngClass","placeholder"],["for","arabicName"],["type","text","pInputText","","formControlName","arabicName",1,"w-full",3,"ngClass","placeholder"],[1,"container-img"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","label"],[3,"src","alt"],["src","assets/layout/images/close-icon.svg","alt","close-icon",1,"close",3,"click"],["for","icon"],["name","icon","id","icon","accept","image/*",3,"onSelect","showUploadButton","showCancelButton","maxFileSize"]],template:function(a,i){a&1&&(s(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),m(4),o(5,"translate"),r(),s(6,"p-multiSelect",4),o(7,"translate"),h("onChange",function(p){return i.onClassificationChange(p)}),r(),E(8,Tt,4,8,"small",5),r(),s(9,"div",6)(10,"label",7),m(11),o(12,"translate"),r(),T(13,"input",8),o(14,"translate"),E(15,Nt,4,8,"small",5)(16,Ft,3,5,"small",5),r(),s(17,"div",6)(18,"label",9),m(19),o(20,"translate"),r(),T(21,"input",10),o(22,"translate"),E(23,Dt,4,8,"small",5)(24,yt,3,5,"small",5),r(),s(25,"div",2),E(26,Lt,3,2,"div",11)(27,Bt,3,3),r()()(),s(28,"div",12)(29,"p-button",13),o(30,"translate"),h("onClick",function(){return i.close()}),r(),s(31,"p-button",14),o(32,"translate"),o(33,"translate"),h("onClick",function(){return i.save()}),r()()),a&2&&(d("formGroup",i.brandForm),n(4),v(c(5,20,"FIELDS.CLASSIFICATIONS")),n(2),d("options",i.classifications)("filter",!0)("showClear",!0)("placeholder",c(7,22,"FIELDS.CLASSIFICATIONS")),n(2),P(i.formError.hasSpecificError("classificationIds","required")?8:-1),n(3),v(c(12,24,"FIELDS.ENGLISH_NAME")),n(2),d("ngClass",S(38,Mi,i.formError.hasError("englishName")))("placeholder",c(14,26,"FIELDS.ENGLISH_NAME")),n(2),P(i.formError.hasSpecificError("englishName","required")?15:-1),n(),P(i.formError.hasSpecificError("englishName","maxlength")?16:-1),n(3),v(c(20,28,"FIELDS.ARABIC_NAME")),n(2),d("ngClass",S(40,Mi,i.formError.hasError("arabicName")))("placeholder",c(22,30,"FIELDS.ARABIC_NAME")),n(2),P(i.formError.hasSpecificError("arabicName","required")?23:-1),n(),P(i.formError.hasSpecificError("arabicName","maxlength")?24:-1),n(2),P(i.brand.icon!=null&&i.brand.icon.blobUrI?26:27),n(3),d("label",c(30,32,"GENERAL.CANCEL")),n(2),d("label",i.brand.id?c(32,34,"GENERAL.UPDATE"):c(33,36,"GENERAL.SAVE")))},dependencies:[B,Ae,H,Fe,W,z,Z,J,K,j,$,ae,oe,Ce,q,ie,w,R,ye,De]})}return t})();var hi={columns:[{field:"name",header:"BRANDNAME",type:"label",exported:!1},{field:"classifications",header:"CLASSIFICATION",type:"label",exported:!0},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",locale:"FIELDS.",actions:["CREATE"],rowsActions:["EDIT","DELETE"],dataLoading:"server",paginator:!0,globalFilterFields:["name"],hasFilters:!0};function xt(t,f){if(t&1&&(s(0,"div",6)(1,"div"),m(2),r()()),t&2){let e=f.$implicit;n(2),v(e.name)}}var Hr=(()=>{class t{_brands;_confirm;_translate;_popup;_toast;destroy$=new F;tableConfig$;filters={number:1,size:10};searchControl=new pe;classifications=[];currentPage=1;totalRecords=0;first=0;pageSize=10;rows=10;selectedClassification=null;constructor(e,a,i,l,p){this._brands=e,this._confirm=a,this._translate=i,this._popup=l,this._toast=p}ngOnInit(){this.getAllBrand(this.filters),this.getClassifications()}getAllBrand(e){this._brands.getBrands(e).pipe(me(a=>A(I({},hi),{rows:a.data?.result.map(i=>A(I({},i),{classifications:(i.classifications||[]).map(l=>l.name)}))||[],totalRecords:a.data?.rowCount}))).subscribe({next:a=>{this.tableConfig$=fe(a)}})}onActionClicked(e){switch(e.action){case"CREATE":this.createBrand();break;case"EDIT":this.editBrand(e.data);break;case"DELETE":this.deleteBrand(e.data);break}}createBrand(){this._popup.open(fi,{title:this._translate.instant("BRANDS.ADD_NEW_BRAND"),position:this._translate.currentLang==="ar"?"left":"right"}).afterClosed.subscribe(e=>e&&this.getAllBrand(this.filters))}editBrand(e){this._popup.open(fi,{title:this._translate.instant("BRANDS.EDIT_BRAND"),position:this._translate.currentLang==="ar"?"left":"right",data:e}).afterClosed.subscribe(a=>a&&this.getAllBrand(this.filters))}deleteBrand(e){e.id&&this._confirm.confirm("delete").subscribe(a=>{a&&this._brands.deleteBrand(e.id).pipe(g(this.destroy$)).subscribe(()=>{this._toast.success(this._translate.instant("BRANDS.DELETE_BRAND_SUCCESS")),this.getAllBrand(this.filters)})})}getClassifications(){this._brands.getClassifications().pipe(g(this.destroy$)).subscribe(e=>{this.classifications=e.data.classifications})}onClassificationChange(e){this.selectedClassification=e.value,this.filterWithClassifications()}filterWithClassifications(){this.selectedClassification?this._brands.getBrands({size:this.rows,number:this.currentPage}).pipe(g(this.destroy$)).subscribe({next:e=>{let a=e.data.result.filter(i=>i.classifications.some(l=>l.id===this.selectedClassification?.id));this.tableConfig$=fe(A(I({},hi),{rows:a.map(i=>A(I({},i),{classifications:(i.classifications||[]).map(l=>l.name).join(", ")}))||[],totalRecords:a.length}))}}):this.getAllBrand({size:this.rows,number:this.currentPage})}onPageChange(e){this.first=e.first||0,this.rows=e.rows||10,this.currentPage=e.page||1,console.log("PageSize:",this.rows,"PageNumber:",this.currentPage),this.getAllBrand({size:this.rows,number:this.currentPage})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(u(Ze),u(ne),u(V),u(M),u(x))};static \u0275cmp=D({type:t,selectors:[["admin-brands"]],standalone:!0,features:[L],decls:9,vars:9,consts:[[3,"actionClicked","onSearch","onPage","config"],["filters-area","",1,"filters","p-grid"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["formControlName","classification","optionLabel","name","filterBy","name","placeholder","Select a classifications",1,"w-full",3,"onChange","options","filter","showClear"],["pTemplate","selectedItem"],[1,"flex","align-items-center","gap-2"]],template:function(a,i){a&1&&(s(0,"shared-ui-table",0),o(1,"async"),h("actionClicked",function(p){return i.onActionClicked(p)})("onSearch",function(p){return i.searchControl.patchValue(p)})("onPage",function(p){return i.onPageChange(p)}),s(2,"div",1)(3,"div",2),m(4),o(5,"translate"),r(),s(6,"div",3)(7,"p-dropdown",4),h("onChange",function(p){return i.onClassificationChange(p)}),E(8,xt,3,1,"ng-template",5),r()()()()),a&2&&(d("config",c(1,5,i.tableConfig$)),n(4),v(c(5,7,"GENERAL.FILTERS")),n(3),d("options",i.classifications)("filter",!0)("showClear",!0))},dependencies:[B,he,Y,$,j,te,ge,oe,re,w,R],encapsulation:2})}return t})();var Je={columns:[{field:"name",header:"UNIT_NAME",type:"label",exported:!1},{field:"shortName",header:"SHORT_NAME",type:"label",exported:!1},{field:"classification",header:"CLASSIFICATION",type:"label",exported:!1},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",locale:"FIELDS.",actions:["CREATE"],rowsActions:["EDIT","DELETE"],dataLoading:"server",paginator:!0};var Vt=()=>({width:"600px",height:"100vh",top:"0",margin:"0",padding:"0"});function wt(t,f){if(t&1&&(s(0,"div",11)(1,"div"),m(2),r()()),t&2){let e=f.$implicit;n(2),v(e.name)}}function Rt(t,f){if(t&1){let e=O();s(0,"div",12)(1,"div",13),m(2),o(3,"translate"),r(),s(4,"button",14),h("click",function(){G(e);let i=y();return k(i.displayDialog=!1)}),T(5,"img",15),r()()}t&2&&(n(2),v(c(3,1,"UNITS.ADD_NEW_UNIT")))}function Mt(t,f){if(t&1){let e=O();s(0,"admin-add-edit-units",16),h("save",function(i){G(e);let l=y();return k(l.handleSave(i))}),r()}if(t&2){let e=y();d("classifications",e.classifications)("unitData",e.selectedUnit)}}var co=(()=>{class t{_toastr;_confirm;_translate;_product;_unsubscribeAll=new F;displayDialog=!1;pageSize=10;pageNumber=1;totalRecords=0;first=0;keyword="";searchControl=new pe;breadcrumb;tableConfig;classifications=[];selectedClassification=null;constructor(e,a,i,l){this._toastr=e,this._confirm=a,this._translate=i,this._product=l}ngOnInit(){this.tableConfig=Je,this.setBreadcrumb(),this.getClassifications(),this.getAllUnits(),this.onSearch(),this._translate.onLangChange.pipe(g(this._unsubscribeAll)).subscribe(e=>{this.setBreadcrumb()})}setBreadcrumb(){this.breadcrumb=[{icon:"pi pi-home",route:"/"},{label:this._translate.instant("UNITS.PRODUCT_MANAGEMENT")},{label:this._translate.instant("UNITS.NAME"),route:"/units"}]}getClassifications(){this._product.getClassifications().pipe(g(this._unsubscribeAll)).subscribe(e=>{this.classifications=e.data.classifications})}getAllUnits(){this._product.getAllUnits(this.pageSize,this.pageNumber,this.keyword).pipe(g(this._unsubscribeAll)).subscribe(e=>{this.tableConfig=A(I({},Je),{rows:e.data.result.map(a=>A(I({},a),{classification:a.classification?.name}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT","DELETE"]})})}onPageChange(e){this.first=e.first||0,this.pageSize=e.rows||10,this.pageNumber=e.page||1,this.getAllUnits()}onActionClicked(e){switch(e.action){case"CREATE":this.selectedUnit=null,this.openCreateDialog();break;case"EDIT":this.getUnitById(e.data);break;case"DELETE":this.onActionDelete(e.data);break;default:break}}openCreateDialog(){this.displayDialog=!0}onDialogClose(){this.displayDialog=!1}onActionDelete(e){this._confirm.confirm("delete").subscribe(a=>{a&&this._product.deleteUnit(e.id).pipe(g(this._unsubscribeAll)).subscribe(i=>{i.data&&(this._toastr.success(this._translate.instant("GENERAL.DELETED_SUCCESSFULLY",{name:this._translate.instant("UNITS.NAME")})),this.getAllUnits())})})}handleSave(e){this.selectedUnit?this._product.editUnit(A(I({},e),{id:this.selectedUnit.id})).pipe(g(this._unsubscribeAll)).subscribe(a=>{a.data&&(this._toastr.success(this._translate.instant("GENERAL.UPDATED_SUCCESSFULLY",{name:this._translate.instant("UNITS.NAME")})),this.getAllUnits(),this.displayDialog=!1)}):this._product.addUnit(e).pipe(g(this._unsubscribeAll)).subscribe(()=>{this.getAllUnits(),this.displayDialog=!1,this._toastr.success(this._translate.instant("GENERAL.ADDED_SUCCESSFULLY",{name:this._translate.instant("UNITS.NAME")}))})}selectedUnit=null;getUnitById(e){let a=typeof e.id=="string"?Number(e.id):e.id;a&&this._product.getUnitById(a).subscribe(i=>{i.data&&(this.displayDialog=!0,this.selectedUnit=i.data)})}onClassificationChange(e){this.selectedClassification=e.value,this.filterUnits()}filterUnits(){this.selectedClassification?this._product.getAllUnits(this.pageSize,this.pageNumber,this.keyword).pipe(g(this._unsubscribeAll)).subscribe(e=>{let a=e.data.result.filter(i=>i.classification?.id===this.selectedClassification?.id);this.tableConfig.rows=a.map(i=>A(I({},i),{classification:i.classification?.name}))}):this.getAllUnits()}onSearch(){this.searchControl.valueChanges.pipe(Ee(e=>e.trim().length>=0),ve(400),be(e=>this._product.getAllUnits(this.pageSize,this.pageNumber,e.trim()))).subscribe(e=>{e&&e.data&&(this.tableConfig=A(I({},Je),{rows:e.data.result.map(a=>A(I({},a),{classification:a.classification?.name}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT","DELETE"]}))})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static \u0275fac=function(a){return new(a||t)(u(x),u(ne),u(V),u(ce))};static \u0275cmp=D({type:t,selectors:[["admin-units"]],standalone:!0,features:[L],decls:13,vars:19,consts:[[1,"dialog-side"],[3,"items"],[3,"onPage","onSearch","actionClicked","config"],["filters-area","",1,"filters","row"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["formControlName","classification","optionLabel","name","filterBy","name","placeholder","Select a classifications",1,"w-full",3,"onChange","options","filter","showClear"],["pTemplate","selectedItem"],[3,"visibleChange","visible","modal","dismissableMask","position","baseZIndex","draggable","blockScroll","closable"],["pTemplate","header"],["pTemplate","content"],[1,"flex","align-items-center","gap-2"],[1,"dialog-header"],[1,"dialog-header__title"],[1,"dialog-header__close-button",3,"click"],["src","assets/layout/images/close-icon.svg","alt","Close",1,"dialog-header__close-icon"],[3,"save","classifications","unitData"]],template:function(a,i){a&1&&(s(0,"section",0),T(1,"pos-ui-breadcrumb",1),s(2,"shared-ui-table",2),h("onPage",function(p){return i.onPageChange(p)})("onSearch",function(p){return i.searchControl.patchValue(p)})("actionClicked",function(p){return i.onActionClicked(p)}),s(3,"div",3)(4,"div",4),m(5),o(6,"translate"),r(),s(7,"div",5)(8,"p-dropdown",6),h("onChange",function(p){return i.onClassificationChange(p)}),E(9,wt,3,1,"ng-template",7),r()()()(),s(10,"p-dialog",8),ke("visibleChange",function(p){return Ge(i.displayDialog,p)||(i.displayDialog=p),p}),E(11,Rt,6,3,"ng-template",9)(12,Mt,1,2,"ng-template",10),r()()),a&2&&(n(),d("items",i.breadcrumb),n(),d("config",i.tableConfig),n(3),v(c(6,16,"GENERAL.FILTERS")),n(3),d("options",i.classifications)("filter",!0)("showClear",!0),n(2),Ei(N(18,Vt)),Pe("visible",i.displayDialog),d("modal",!0)("dismissableMask",!0)("position","right")("baseZIndex",1e4)("draggable",!1)("blockScroll",!0)("closable",!1))},dependencies:[B,Y,j,te,ge,Fi,w,R,Ti,re,Ni],encapsulation:2})}return t})();var Ke=(()=>{class t{_http;constructor(e){this._http=e}getClassifications(){return this._http.get(`${X.URL_API}Classifications`)}getAllTags(e){return this._http.get(`${X.URL_API}Tags?TagTypeIds=2&PageSize=${e.size}&PageNumber=${e.number}`)}deleteTags(e){return this._http.delete(`${X.URL_API}Tags/${e}`)}addTags(e){return this._http.post(`${X.URL_API}Tags`,e)}editTags(e){return this._http.put(`${X.URL_API}Tags`,e)}getTagsById(e){return this._http.get(`/api/Tags/${e}`)}static \u0275fac=function(a){return new(a||t)(Ue(je))};static \u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Gi=t=>({"ng-dirty ng-invalid":t}),gi=t=>({fieldName:t}),ki=()=>({maxLength:50});function Ut(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,gi,c(2,1,"FIELDS.classificationIds")))," "))}function Pt(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,gi,c(2,1,"FIELDS.ENGLISH_NAME")))," "))}function Gt(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,ki))," "))}function kt(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),o(3,"translate"),r()),t&2&&(n(),_(" ",C(3,3,"GENERAL.FIELD_REQUIRED",S(6,gi,c(2,1,"FIELDS.ARABIC_NAME")))," "))}function Ot(t,f){t&1&&(s(0,"small",5),m(1),o(2,"translate"),r()),t&2&&(n(),_(" ",C(2,1,"GENERAL.MAX_LENGTH_EXCEEDED",N(4,ki))," "))}var _i=(()=>{class t{_tag;_popup;_translate;_toastr;_fb;destroy$=new F;formError;tagForm;tag;classifications=[];selectedTag;constructor(e,a,i,l,p){this._tag=e,this._popup=a,this._translate=i,this._toastr=l,this._fb=p}ngOnInit(){this.tag=this._popup.getData(),this.tagForm=this.initForm(),this.formError=new Ne.ErrorManagement(this.tagForm),this.tag&&this.tag.tagId&&this.getTagsDetails({tagId:this.tag.tagId}),this.getClassifications()}getClassifications(){this._tag.getClassifications().pipe(g(this.destroy$)).subscribe({next:e=>{this.classifications=e.data.classifications}})}getTagsDetails(e){let a=typeof e.tagId=="string"?Number(e.tagId):e.tagId;a&&!isNaN(a)&&this._tag.getTagsById(a).subscribe(i=>{i.data&&(this.selectedTag=i.data,this.selectedTag.classificationIds=(this.selectedTag.classificationIds||[]).map(l=>l.id),this.patchFormData())})}initForm(){return this._fb.group({classificationIds:[[],[b.required]],arabicName:["",[b.required]],englishName:["",[b.required]],TagTypeId:[2]})}patchFormData(){this.tagForm.patchValue({classificationIds:this.selectedTag.classificationIds||[],arabicName:this.selectedTag.arabicName,englishName:this.selectedTag.englishName})}save(){let e=this.tagForm.getRawValue();(e.id?this._tag.editTags(e):this._tag.addTags(e)).pipe(g(this.destroy$)).subscribe(()=>this.afterSavingDone(e.id?"edit":"add",e))}afterSavingDone(e,a){let i=this._translate.currentLang==="ar"?a?.arabicName:a?.englishName;this._translate.get(e?"GENERAL.ADDED_SUCCESSFULLY":"UPDATED_SUCCESSFULLY",{name:i}).subscribe(l=>this._toastr.success(l)),this._popup.close(!0)}close=()=>this._popup.close();onClassificationChange(e){this.tagForm.get("classificationId")?.setValue(e.value.id),this.tagForm.get("classification")?.setValue(e.value)}static \u0275fac=function(a){return new(a||t)(u(Ke),u(M),u(V),u(x),u(ee))};static \u0275cmp=D({type:t,selectors:[["admin-tags-form"]],standalone:!0,features:[L],decls:31,vars:41,consts:[["autocomplete","off",3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],["for","classificationIds"],["formControlName","classificationIds","optionLabel","name","optionValue","id","filterBy","name",3,"onChange","options","filter","showClear","placeholder"],["id","serviceType-error",1,"text-error"],[1,"field","col-12","md:col-6"],["for","englishName"],["pInputText","","type","text","pInputText","","formControlName","englishName",1,"w-full",3,"ngClass","placeholder"],["for","arabicName"],["type","text","pInputText","","formControlName","arabicName",1,"w-full",3,"ngClass","placeholder"],[1,"flex","gap-2","align-items-center","justify-content-end"],["severity","danger",3,"onClick","label"],["severity","primary",3,"onClick","label"]],template:function(a,i){a&1&&(s(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),m(4),o(5,"translate"),r(),s(6,"p-multiSelect",4),o(7,"translate"),h("onChange",function(p){return i.onClassificationChange(p)}),r(),E(8,Ut,4,8,"small",5),r(),s(9,"div",6)(10,"label",7),m(11),o(12,"translate"),r(),T(13,"input",8),o(14,"translate"),E(15,Pt,4,8,"small",5)(16,Gt,3,5,"small",5),r(),s(17,"div",6)(18,"label",9),m(19),o(20,"translate"),r(),T(21,"input",10),o(22,"translate"),E(23,kt,4,8,"small",5)(24,Ot,3,5,"small",5),r()()(),s(25,"div",11)(26,"p-button",12),o(27,"translate"),h("onClick",function(){return i.close()}),r(),s(28,"p-button",13),o(29,"translate"),o(30,"translate"),h("onClick",function(){return i.save()}),r()()),a&2&&(d("formGroup",i.tagForm),n(4),v(c(5,19,"FIELDS.CLASSIFICATIONS")),n(2),d("options",i.classifications)("filter",!0)("showClear",!0)("placeholder",c(7,21,"FIELDS.CLASSIFICATIONS")),n(2),P(i.formError.hasSpecificError("classificationIds","required")?8:-1),n(3),v(c(12,23,"FIELDS.ENGLISH_NAME")),n(2),d("ngClass",S(37,Gi,i.formError.hasError("englishName")))("placeholder",c(14,25,"FIELDS.ENGLISH_NAME")),n(2),P(i.formError.hasSpecificError("englishName","required")?15:-1),n(),P(i.formError.hasSpecificError("englishName","maxlength")?16:-1),n(3),v(c(20,27,"FIELDS.ARABIC_NAME")),n(2),d("ngClass",S(39,Gi,i.formError.hasError("arabicName")))("placeholder",c(22,29,"FIELDS.ARABIC_NAME")),n(2),P(i.formError.hasSpecificError("arabicName","required")?23:-1),n(),P(i.formError.hasSpecificError("arabicName","maxlength")?24:-1),n(2),d("label",c(27,31,"GENERAL.CANCEL")),n(2),d("label",i.tag.id?c(29,33,"GENERAL.UPDATE"):c(30,35,"GENERAL.SAVE")))},dependencies:[B,Ae,H,Fe,W,z,Z,J,K,j,$,ae,oe,Ce,q,ie,w,R],encapsulation:2})}return t})();var Ci={columns:[{field:"tagName",header:"TAGNAME",type:"label",exported:!1},{field:"classifications",header:"CLASSIFICATION",type:"label",exported:!1},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",actions:["CREATE"],rowsActions:["EDIT","DELETE"],dataLoading:"server",paginator:!0,globalFilterFields:["tagName","classifications"],locale:"FIELDS.",hasFilters:!0};function jt(t,f){if(t&1&&(s(0,"div",6)(1,"div"),m(2),r()()),t&2){let e=f.$implicit;n(2),v(e.name)}}var Jo=(()=>{class t{tagService;confirmService;translateService;popupService;toastrService;destroy$=new F;tableConfig$;searchControl=new pe;classifications=[];currentPage=1;totalRecords=0;first=0;pageSize=10;rows=10;selectedClassification=null;filters={number:1,size:10};constructor(e,a,i,l,p){this.tagService=e,this.confirmService=a,this.translateService=i,this.popupService=l,this.toastrService=p}ngOnInit(){this.getTags(this.filters),this.getClassifications()}getTags(e){this.tagService.getAllTags(e).pipe(me(a=>A(I({},Ci),{rows:a.data.result.map(i=>A(I({},i),{classifications:(i.classifications||[]).map(l=>l.name).join(", ")}))||[],totalRecords:a.data.rowCount}))).subscribe({next:a=>this.tableConfig$=fe(a)})}onActionClicked(e){switch(e.action){case"CREATE":this.createTags();break;case"EDIT":this.editTags(e.data);break;case"DELETE":this.deleteTags(e.data);break}}createTags(){this.popupService.open(_i,{title:this.translateService.instant("TAGS.ADD_NEW_TAG"),position:this.translateService.currentLang==="ar"?"left":"right"}).afterClosed.subscribe(e=>{e&&this.getTags(this.filters)})}editTags(e){this.popupService.open(_i,{title:this.translateService.instant("Tags.EDIT_TAG"),position:this.translateService.currentLang==="ar"?"left":"right",data:e}).afterClosed.subscribe(a=>{a&&this.getTags(this.filters)})}deleteTags(e){e.tagId&&this.confirmService.confirm("delete").subscribe(a=>{a&&this.tagService.deleteTags(e.tagId).pipe(g(this.destroy$)).subscribe(i=>{i.data&&(this.toastrService.success("Tag deleted successfully"),this.getTags({size:this.rows,number:this.currentPage}))})})}getClassifications(){this.tagService.getClassifications().pipe(g(this.destroy$)).subscribe(e=>{this.classifications=e.data.classifications})}onClassificationChange(e){this.selectedClassification=e.value,this.filterWithClassifications()}filterWithClassifications(){this.selectedClassification?this.tagService.getAllTags({size:this.rows,number:this.currentPage}).pipe(g(this.destroy$)).subscribe(e=>{let a=e.data.result.filter(i=>i.classifications?.some(l=>l.id===this.selectedClassification?.id)??!1);this.tableConfig$=fe(A(I({},Ci),{rows:a.map(i=>A(I({},i),{classifications:(i.classifications||[]).map(l=>l.name).join(", ")}))||[],totalRecords:a.length}))}):this.getTags({size:this.rows,number:this.currentPage})}onPageChange(e){this.first=e.first||0,this.rows=e.rows||10,this.currentPage=e.page||1,this.getTags({size:this.rows,number:this.currentPage})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(a){return new(a||t)(u(Ke),u(ne),u(V),u(M),u(x))};static \u0275cmp=D({type:t,selectors:[["admin-tags"]],standalone:!0,features:[L],decls:9,vars:9,consts:[[3,"actionClicked","onSearch","onPage","config"],["filters-area","",1,"filters","p-grid"],[1,"filters-item","col-2","p-0"],[1,"filters-actions","col-4","p-0"],["formControlName","classification","optionLabel","name","filterBy","name","placeholder","Select a classifications",1,"w-full",3,"onChange","options","filter","showClear"],["pTemplate","selectedItem"],[1,"flex","align-items-center","gap-2"]],template:function(a,i){a&1&&(s(0,"shared-ui-table",0),o(1,"async"),h("actionClicked",function(p){return i.onActionClicked(p)})("onSearch",function(p){return i.searchControl.patchValue(p)})("onPage",function(p){return i.onPageChange(p)}),s(2,"div",1)(3,"div",2),m(4),o(5,"translate"),r(),s(6,"div",3)(7,"p-dropdown",4),h("onChange",function(p){return i.onClassificationChange(p)}),E(8,jt,3,1,"ng-template",5),r()()()()),a&2&&(d("config",c(1,5,i.tableConfig$)),n(4),v(c(5,7,"GENERAL.FILTERS")),n(3),d("options",i.classifications)("filter",!0)("showClear",!0))},dependencies:[B,he,Y,$,j,te,ge,oe,re,w,R],encapsulation:2})}return t})();export{Ia as a,ln as b,nr as c,Hr as d,co as e,Jo as f};
