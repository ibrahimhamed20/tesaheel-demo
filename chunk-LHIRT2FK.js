import{g as z,i as H,j as q}from"./chunk-XZBQBUMW.js";import{d as N,f as $}from"./chunk-BTTLIBHC.js";import{g as V}from"./chunk-WIKX5TMA.js";import{e as U,f as B,g as F}from"./chunk-UEPQDKEL.js";import{a as n}from"./chunk-ORBEOOVW.js";import{b as L}from"./chunk-LY326WX5.js";import{s as j,t as O}from"./chunk-AGN6QKO6.js";import{l as x}from"./chunk-V6BOHIKZ.js";import{$a as k,J as w,K as f,Kc as D,Ma as p,Mb as E,Na as s,O as v,T,Y as A,_b as I,bb as u,f as M,ga as a,ha as c,lb as l,mb as m,nb as R,rb as C,tb as h,ub as b,v as y,y as S}from"./chunk-CD6VLWCW.js";import{a as g,b as P}from"./chunk-4CLCTAJ7.js";var J={columns:[{field:"name",header:"PRODUCTNAME",type:"label",exported:!1},{field:"category",header:"CATEGORY",type:"label",exported:!0},{field:"brand",header:"BRAND",type:"label",exported:!0},{field:"actions",header:"ACTIONS",type:"actions",exported:!1}],rows:[{name:"Product 1",category:"category",brand:"brand"},{name:"Product 2",category:"category",brand:"brand"},{name:"Product 3",category:"category",brand:"brand"}],rowsPerPage:10,rowsPerPageOptions:[5,10,15,20,25,50,100],selectionMode:"single",rowsActions:["EDIT","DELETE"],actions:["Link"],paginator:!0,dataLoading:"server",locale:"FIELDS."};var K=(()=>{class i{_http;constructor(t){this._http=t}geMerchantProductDefination(t){let e=`Pagination.PageSize=${t.pageSize}&Pagination.PageNumber=${t.pageNumber}`;return this._http.get(`${n.URL_API}definitions?Status=new${e}`)}getMerchantProduct(t){let e=`Pagination.PageSize=${t.pageSize}&Pagination.PageNumber=${t.pageNumber}&Status=${t.Status}
 `;return this._http.get(`${n.URL_API}MerchantProducts/definitions?${e}`)}getMerchantProductById(t){return this._http.get(`${n.URL_API}MerchantProducts/definitions/${t}`)}searchForMerchantProduct(t){return this._http.get(`${n.URL_API}MerchantProducts/true/${t}`)}linkProducts(t){return this._http.put(`${n.URL_API}MerchantProducts/link`,t)}rejectProduct(t){return this._http.put(`${n.URL_API}MerchantProducts/change-status`,t)}approveProduct(t){return this._http.put(`${n.URL_API}MerchantProducts/change-status`,t)}static \u0275fac=function(e){return new(e||i)(T($))};static \u0275prov=v({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Q(i,W){if(i&1){let t=C();l(0,"div",4)(1,"p-button",5),h("click",function(){let r=a(t).$implicit,o=b();return c(o.onActionClicked({action:"LINK",data:r}))}),m(),l(2,"p-button",6),h("click",function(){let r=a(t).$implicit,o=b();return c(o.onActionClicked({action:"APPROVE",data:r}))}),m(),l(3,"p-button",7),h("click",function(){let r=a(t).$implicit,o=b();return c(o.onActionClicked({action:"REJECT",data:r}))}),m()()}i&2&&(p(),u("rounded",!0)("outlined",!0),p(),u("rounded",!0)("outlined",!0),p(),u("rounded",!0)("outlined",!0))}var Ct=(()=>{class i{_router;_toast;_confirm;_translate;_merchantProducts;_unsubscribeAll=new M;tableConfig;searchControl=new V;breadcrumb;filters={pageNumber:1,pageSize:10};constructor(t,e,r,o,_){this._router=t,this._toast=e,this._confirm=r,this._translate=o,this._merchantProducts=_}ngOnInit(){this.getMerchantProducts(this.filters),this.onSearchData(),this.setBreadcrumb()}setBreadcrumb(){this.breadcrumb=[{icon:"pi pi-home",route:"/"},{label:this._translate.instant("MERCHANTS_PRODUCTS.MERCHANTPRODUCTS")},{label:this._translate.instant("MERCHANTS_PRODUCTS.NAME"),route:"/"}]}onSearchData(){this.searchControl.valueChanges.pipe(y(t=>t.trim()?.length>0),S(400),w(t=>this._merchantProducts.searchForMerchantProduct(t))).subscribe(t=>this.tableConfig.rows=t.data)}onPageChange(t){this.filters={pageSize:t.rows||10,pageNumber:t.page||1},this.getMerchantProducts(this.filters)}onActionClicked(t){switch(t.action){case"APPROVE":this.approveMerchantProduct(t.data);break;case"REJECT":this.rejectMerchantProduct(t.data);break;case"LINK":default:this._router.navigate([`/products/link-products/${t.data.id}`]);break}}getMerchantProducts(t){this._merchantProducts.getMerchantProduct(P(g({},t),{Status:"new"})).pipe(f(this._unsubscribeAll)).subscribe(e=>this.tableConfig=P(g({},J),{rows:e.data.result,totalRecords:e.data.rowCount}))}approveMerchantProduct(t){this._confirm.confirm("confirm").subscribe(e=>{e&&this._merchantProducts.approveProduct({productDefinitionId:t.id,merchantProductStatus:"approved"}).pipe(f(this._unsubscribeAll)).subscribe(r=>{r&&(this._toast.success("Product Aproved Successfully"),this.getMerchantProducts(this.filters))})})}rejectMerchantProduct(t){this._confirm.confirm("warn").subscribe(e=>{e&&this._merchantProducts.rejectProduct({productDefinitionId:t.id,merchantProductStatus:"rejected"}).pipe(f(this._unsubscribeAll)).subscribe(r=>{r&&(this._toast.success("Product Rejected Successfully"),this.getMerchantProducts(this.filters))})})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static \u0275fac=function(e){return new(e||i)(s(x),s(N),s(q),s(L),s(K))};static \u0275cmp=A({type:i,selectors:[["admin-merchantproducts"]],standalone:!0,features:[E],decls:6,vars:2,consts:[["actions",""],[3,"items"],[1,"card"],[3,"actionClicked","onPage","onSearch","config"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-link","severity","warning",1,"mr-2",3,"click","rounded","outlined"],["pRipple","","icon","pi pi-check","severity","primary",1,"mr-2",3,"click","rounded","outlined"],["pButton","","pRipple","","icon","pi pi-times","severity","danger",3,"click","rounded","outlined"]],template:function(e,r){if(e&1){let o=C();R(0,"pos-ui-breadcrumb",1)(1,"br"),l(2,"div",2)(3,"shared-ui-table",3),h("actionClicked",function(d){return a(o),c(r.onActionClicked(d))})("onPage",function(d){return a(o),c(r.onPageChange(d))})("onSearch",function(d){return a(o),c(r.searchControl.patchValue(d))}),k(4,Q,4,6,"ng-template",null,0,I),m()()}e&2&&(u("items",r.breadcrumb),p(3),u("config",r.tableConfig))},dependencies:[D,z,F,U,B,O,j,H],encapsulation:2})}return i})();export{K as a,Ct as b};
