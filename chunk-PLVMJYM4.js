import{a as Fe,b as ne,c as Y,d as at,e as ct,f as lt,g as st,h as dt,i as pt}from"./chunk-PZBLBS4V.js";import{a as De,b as B}from"./chunk-CJUDCIES.js";import{a as Te,b as xe}from"./chunk-YVOJF66O.js";import{a as Ae,b as nt}from"./chunk-LHIRT2FK.js";import"./chunk-OCK53PXK.js";import{g as q,i as Q,j as Me}from"./chunk-XZBQBUMW.js";import"./chunk-BT273UET.js";import{d as pe}from"./chunk-BTTLIBHC.js";import{B as ke,m as Se,n as R,t as X,u as we,z as Ee}from"./chunk-W23ROTL5.js";import{e as H,f as fe,g as A,h as ge,i as he,k as _e,n as Ce,r as be,s as Pe,t as ve,w as ye,x as Ie}from"./chunk-WIKX5TMA.js";import{f as J,g as K}from"./chunk-UEPQDKEL.js";import"./chunk-ORBEOOVW.js";import{c as me,d as ue}from"./chunk-LY326WX5.js";import"./chunk-NJC4F6AZ.js";import{n as de,o as $}from"./chunk-AGN6QKO6.js";import{j as x,l as D}from"./chunk-V6BOHIKZ.js";import{$a as Z,Ac as W,Db as G,Eb as p,Fb as g,Gb as te,Gc as se,Ib as ie,J as F,Jb as oe,K as S,Kb as re,Kc as C,Ma as c,Mb as w,Na as d,Nb as U,P as V,Xb as m,Y as h,Yb as u,Z as j,bb as l,f as E,ga as y,ha as I,lb as r,mb as n,na as le,nb as _,rb as T,t as ce,tb as f,ub as L,v as k,vb as O,wb as z,xb as ee,y as M}from"./chunk-CD6VLWCW.js";import{a as P,b as v}from"./chunk-4CLCTAJ7.js";var yt=(()=>{class i{_router;_route;_product;breadcrumb=[{icon:"pi pi-home",route:"/"},{label:"Products"},{label:"Products Catalog",route:"/products/products-catalog"}];_unsubscribeAll=new E;tableConfig;selectedClassification=null;pageSize=10;pageNumber=1;totalRecords=0;first=0;keyword="";searchControl=new A;constructor(e,t,o){this._router=e,this._route=t,this._product=o}ngOnInit(){this.getAllProductCatalog(),this.onSearch(),this.tableConfig=Y}onActionClicked(e){switch(e.action){case"CREATE":this._router.navigate(["0"],{relativeTo:this._route});break;default:break}}getAllProductCatalog(){this._product.getAllProductCatalog(this.pageSize,this.pageNumber,this.keyword).pipe(S(this._unsubscribeAll)).subscribe(e=>{this.tableConfig=v(P({},Y),{rows:e.data.map(t=>v(P({},t),{paidProduct:t.numberOfPrdoucts+" Product  "+t.price+" EGP"}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT"]})})}onPageChange(e){this.first=e.first||0,this.pageSize=e.rows||10,this.pageNumber=e.page||1,this.getAllProductCatalog()}handleSave(e){}onSearch(){this.searchControl.valueChanges.pipe(k(e=>e.trim().length>=0),M(400),F(e=>this._product.getAllProductCatalog(this.pageSize,this.pageNumber,e.trim()))).subscribe(e=>{e&&e.data&&(this.tableConfig=v(P({},Y),{rows:e.data.map(t=>v(P({},t),{paidProduct:t.numberOfPrdoucts+" Product  "+t.price+" EGP"}))||[],totalRecords:e.data.rowCount,rowsActions:["EDIT"]}))})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static \u0275fac=function(t){return new(t||i)(d(D),d(x),d(B))};static \u0275cmp=h({type:i,selectors:[["admin-products-catalog"]],standalone:!0,features:[w],decls:4,vars:2,consts:[[3,"items"],[3,"actionClicked","onPage","onSearch","config"]],template:function(t,o){t&1&&(_(0,"pos-ui-breadcrumb",0)(1,"br"),r(2,"section")(3,"shared-ui-table",1),f("actionClicked",function(s){return o.onActionClicked(s)})("onPage",function(s){return o.onPageChange(s)})("onSearch",function(s){return o.searchControl.patchValue(s)}),n()()),t&2&&(l("items",o.breadcrumb),c(3),l("config",o.tableConfig))},dependencies:[C,Q,q,R,Fe],encapsulation:2})}return i})();var Ne=(()=>{class i{_fb;_product;onFilter=new le;filterForm;filterData$;constructor(e,t){this._fb=e,this._product=t}ngOnInit(){this.filterForm=this.initializeForm(),this.filterData$=this.getData()}initializeForm(){return this._fb.group({ClassificationId:[""],BrandId:[""],Unit:[""],CategoryId:[""]})}getData(){return ce({classifications:this._product.getClassifications(),categories:this._product.getCategories(),brands:this._product.getAllBrands(1e5,1)})}onSubmit(){this.onFilter.emit(this.filterForm.value)}onReset(){this.filterForm.reset(),this.onFilter.emit(this.filterForm.value)}static \u0275fac=function(t){return new(t||i)(d(be),d(B))};static \u0275cmp=h({type:i,selectors:[["admin-product-filter"]],outputs:{onFilter:"onFilter"},standalone:!0,features:[w],decls:13,vars:15,consts:[[1,"p-fluid","p-formgrid","grid",3,"ngSubmit","formGroup"],[1,"col-12","md:col-3"],["optionLabel","name","optionValue","id","placeholder","Select a Classification","formControlName","ClassificationId","filterBy","name",3,"options","filter"],["optionLabel","name","optionValue","id","placeholder","Select a Brand","formControlName","BrandId","filterBy","name",3,"options","filter"],["optionLabel","name","optionValue","id","placeholder","Select a Category","formControlName","CategoryId","filterBy","name",3,"options","filter"],[1,"col-12","md:col-3","flex","justify-content-end","align-items-center"],["type","submit","label","Filter","severity","success",1,"mr-2",3,"outlined"],["label","Reset","severity","warning",3,"click","outlined"]],template:function(t,o){if(t&1&&(r(0,"form",0),f("ngSubmit",function(){return o.onSubmit()}),r(1,"div",1),_(2,"p-dropdown",2),m(3,"async"),n(),r(4,"div",1),_(5,"p-dropdown",3),m(6,"async"),n(),r(7,"div",1),_(8,"p-dropdown",4),m(9,"async"),n(),r(10,"div",5),_(11,"p-button",6),r(12,"p-button",7),f("click",function(){return o.onReset()}),n()()()),t&2){let a,s,ae;l("formGroup",o.filterForm),c(2),l("options",(a=u(3,9,o.filterData$))==null?null:a.classifications)("filter",!0),c(3),l("options",(s=u(6,11,o.filterData$))==null?null:s.brands)("filter",!0),c(3),l("options",(ae=u(9,13,o.filterData$))==null?null:ae.categories)("filter",!0),c(3),l("outlined",!0),c(),l("outlined",!0)}},dependencies:[C,se,R,Se,ve,he,H,fe,_e,Ce,K,J],encapsulation:2,changeDetection:0})}return i})();var ti=(()=>{class i{_router;_route;_confirm;productService;_unsubscribeAll=new E;tableConfig;items;currentPage=1;totalRecords=0;first=0;rows=10;breadcrumb=[{icon:"pi pi-home",route:"/"},{label:"Products Management"},{label:"Product",route:"/product"}];searchControl=new A;constructor(e,t,o,a){this._router=e,this._route=t,this._confirm=o,this.productService=a}ngOnInit(){this.getProducts({pageSize:this.rows,pageNumber:this.currentPage}),this.onSearch()}getProducts(e){this.productService.getProducts(e).pipe(S(this._unsubscribeAll)).subscribe(t=>{if(t&&t.data){let o=t.data.result.map(a=>v(P({},a),{unit:a.unit?a.unit.name:"-",classification:a.classification?a.classification.name:"No Classification"}));this.tableConfig=v(P({},ne),{rows:o,totalRecords:t.data.rowCount,rowsActions:["EDIT","DELETE"]}),this.totalRecords=t.data.rowCount}})}deleteProduct(e){this.productService.deleteProduct(e).subscribe({next:()=>{this.getProducts({pageSize:this.rows,pageNumber:this.currentPage})}})}onPageChange(e){this.first=e.first||0,this.rows=e.rows||10,this.currentPage=e.page||1,this.getProducts({pageSize:this.rows,pageNumber:this.currentPage})}exportProducts(){this.productService.downloadProdctsAsCsv().subscribe({next:e=>{De(e,"products.csv")}})}onActionClicked(e){switch(e.action){case"CREATE":this._router.navigate(["product/id"],{relativeTo:this._route});break;case"DELETE":this._confirm.confirm("delete").subscribe(t=>{t&&e.data?.id&&this.deleteProduct(e.data.id)});break;case"EXPORT":this.exportProducts();break;case"NAVIGATE":this._router.navigate(["products/product-details",e.data?.id]);break;default:break}}onFilter(e){console.log(e),this.getProducts({pageSize:this.rows,pageNumber:this.currentPage,ClassificationId:e.ClassificationId,BrandId:e.BrandId,CategoryId:e.CategoryId})}onSearch(){this.searchControl.valueChanges.pipe(k(e=>e.trim().length>=0),M(400),F(e=>this.productService.getProducts({pageSize:this.rows,pageNumber:this.currentPage,Keyword:e.trim()}))).subscribe(e=>{e&&e.data&&(this.tableConfig=v(P({},ne),{rows:e.data.result,totalRecords:e.data.rowCount,rowsActions:["EDIT","DELETE"]}),this.totalRecords=e.data.rowCount)})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static \u0275fac=function(t){return new(t||i)(d(D),d(x),d(Me),d(B))};static \u0275cmp=h({type:i,selectors:[["admin-product"]],standalone:!0,features:[w],decls:10,vars:2,consts:[[3,"items"],[1,"grid"],[1,"col-12"],[1,"card"],[1,"mb-4"],[3,"actionClicked","onSearch","onPage","config"],["filters-area","",1,"mt-4"],[3,"onFilter"]],template:function(t,o){t&1&&(_(0,"pos-ui-breadcrumb",0)(1,"br"),r(2,"div",1)(3,"div",2)(4,"div",3)(5,"h4",4),p(6,"Product Management"),n(),r(7,"shared-ui-table",5),f("actionClicked",function(s){return o.onActionClicked(s)})("onSearch",function(s){return o.searchControl.patchValue(s)})("onPage",function(s){return o.onPageChange(s)}),r(8,"div",6)(9,"admin-product-filter",7),f("onFilter",function(s){return o.onFilter(s)}),n()()()()()()),t&2&&(l("items",o.breadcrumb),c(7),l("config",o.tableConfig))},dependencies:[C,q,Q,ke,R,Ne,X],encapsulation:2})}return i})();var We=["*"],Ve=(()=>{class i{iconPosition="left";get containerClass(){return{"p-icon-field-left":this.iconPosition==="left","p-icon-field-right":this.iconPosition==="right"}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=h({type:i,selectors:[["p-iconField"]],inputs:{iconPosition:"iconPosition"},ngContentSelectors:We,decls:2,vars:1,consts:[[1,"p-icon-field",3,"ngClass"]],template:function(t,o){t&1&&(O(),r(0,"span",0),z(1),n()),t&2&&l("ngClass",o.containerClass)},dependencies:[W],styles:[`@layer primeng{.p-icon-field{position:relative}}
`],encapsulation:2,changeDetection:0})}return i})(),je=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=j({type:i});static \u0275inj=V({imports:[C,$]})}return i})();var He=["*"],Oe=(()=>{class i{styleClass;static \u0275fac=function(t){return new(t||i)};static \u0275cmp=h({type:i,selectors:[["p-inputIcon"]],inputs:{styleClass:"styleClass"},ngContentSelectors:He,decls:2,vars:1,consts:[[1,"p-input-icon",3,"ngClass"]],template:function(t,o){t&1&&(O(),r(0,"span",0),z(1),n()),t&2&&l("ngClass",o.styleClass)},dependencies:[W],styles:[`@layer primeng{.p-fluid .p-icon-field-left,.p-fluid .p-icon-field-right{width:100%}}
`],encapsulation:2,changeDetection:0})}return i})(),ze=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=j({type:i});static \u0275inj=V({imports:[C,$]})}return i})();var Ke=()=>["name"],Xe=()=>({"min-width":"30rem"}),qe=()=>[5,10,20];function Qe(i,b){if(i&1){let e=T();r(0,"div",18)(1,"p-iconField",19)(2,"p-inputIcon"),_(3,"i",20),n(),r(4,"input",21,2),m(6,"translate"),f("input",function(){y(e);let o=G(5);L();let a=G(6);return I(a.filterGlobal(o.value,"contains"))}),n()()()}i&2&&(c(4),ee("placeholder",u(6,1,"FIELDS.SEARCH")))}function Ye(i,b){i&1&&(r(0,"tr")(1,"th"),p(2),m(3,"translate"),n(),r(4,"th"),p(5),m(6,"translate"),n(),r(7,"th"),p(8),m(9,"translate"),n(),r(10,"th"),p(11),m(12,"translate"),n()()),i&2&&(c(2),g(u(3,4,"FIELDS.PRODUCTNAME")),c(3),g(u(6,6,"FIELDS.BARCODE")),c(3),g(u(9,8,"FIELDS.COST")),c(3),g(u(12,10,"FIELDS.PRICE")))}function Ze(i,b){if(i&1){let e=T();r(0,"tr")(1,"td",22)(2,"p-checkbox",23),re("ngModelChange",function(o){let a=y(e).$implicit;return oe(a.checked,o)||(a.checked=o),I(o)}),n(),r(3,"span"),p(4),n()(),r(5,"td"),p(6),n(),r(7,"td"),p(8),n(),r(9,"td"),p(10),n()()}if(i&2){let e=b.$implicit,t=L();c(2),ie("ngModel",e.checked),l("disabled",t.disabledProducts),c(2),te(" ",e.name," "),c(2),g(e.barCode),c(2),g(e.cost),c(2),g(e.price)}}function et(i,b){i&1&&(r(0,"tr")(1,"td",24),p(2),m(3,"translate"),n()()),i&2&&(c(2),g(u(3,1,"GENERAL.NODATA")))}function tt(i,b){if(i&1){let e=T();r(0,"div",18)(1,"p-iconField",19)(2,"p-inputIcon"),_(3,"i",20),n(),r(4,"input",21,3),m(6,"translate"),f("input",function(){y(e);let o=G(5),a=L();return I(a.searchControl.patchValue(o.value))}),n()()()}i&2&&(c(4),ee("placeholder",u(6,1,"FIELDS.SEARCH")))}function it(i,b){i&1&&(r(0,"tr")(1,"th"),p(2),m(3,"translate"),n(),r(4,"th"),p(5),m(6,"translate"),n()()),i&2&&(c(2),g(u(3,2,"FIELDS.PRODUCTNAME")),c(3),g(u(6,4,"FIELDS.BARCODE")))}function ot(i,b){if(i&1){let e=T();r(0,"tr")(1,"td",25)(2,"p-checkbox",23),re("ngModelChange",function(o){let a=y(e).$implicit;return oe(a.checked,o)||(a.checked=o),I(o)}),n(),r(3,"span"),p(4),n()(),r(5,"td"),p(6),n()()}if(i&2){let e=b.$implicit,t=L();c(2),ie("ngModel",e.checked),l("disabled",t.disabledProducts),c(2),te(" ",e.name," "),c(2),g(e.barCode)}}function rt(i,b){i&1&&(r(0,"tr")(1,"td",26),p(2),m(3,"translate"),n()()),i&2&&(c(2),g(u(3,1,"GENERAL.NODATA")))}var Mi=(()=>{class i{_router;toaster;activatedRoute;_merchantProducts;_unsubscribeAll=new E;searchControl=new A;merchantProducts=[];products=[];constructor(e,t,o,a){this._router=e,this.toaster=t,this.activatedRoute=o,this._merchantProducts=a}ngOnInit(){let e=+this.activatedRoute.snapshot.params.id;this.getMerchantProductbyId(e),this.onProductsSearch()}getMerchantProductbyId(e){this._merchantProducts.getMerchantProductById(e).pipe(S(this._unsubscribeAll)).subscribe(t=>this.merchantProducts=t.data||[])}onProductsSearch(){this.searchControl.valueChanges.pipe(k(e=>e.trim().length>0),M(400),F(e=>this._merchantProducts.searchForMerchantProduct(e.trim())),S(this._unsubscribeAll)).subscribe(e=>{this.products=e.data||[]})}save(){let e=[{productId:this.products.find(t=>t.checked).id,merchantProductId:this.merchantProducts.find(t=>t.checked).id}];this._merchantProducts.linkProducts({productsToCatalogs:e}).pipe(S(this._unsubscribeAll)).subscribe(()=>{this.toaster.success("Products linked successfully"),this._back()})}get disabledProducts(){return this.merchantProducts.some(e=>e.checked)&&this.products.some(e=>e.checked)}clear(){this.merchantProducts.forEach(e=>e.checked=!1),this.products.forEach(e=>e.checked=!1)}_back=()=>this._router.navigate(["/products/merchant"]);ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static \u0275fac=function(t){return new(t||i)(d(D),d(pe),d(x),d(Ae))};static \u0275cmp=h({type:i,selectors:[["admin-link-products"]],standalone:!0,features:[w],decls:21,vars:13,consts:[["dt1",""],["dt2",""],["mprodsearch",""],["prodsearch",""],[1,"card",2,"border-radius","0"],[1,"grid"],["label","Back","icon","pi pi-angle-left",1,"p-button-link",3,"onClick","text"],[1,"grid","mt-2"],[1,"col-6"],["styleClass","p-datatable-gridlines",3,"value","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["styleClass","p-datatable-gridlines",3,"value","paginator","rows","tableStyle","rowsPerPageOptions"],[1,"flex","gap-2","align-items-center","justify-content-end"],["label","Clear","severity","danger",3,"onClick","disabled"],["label","Save","severity","primary",3,"onClick","disabled"],[1,"flex"],["iconPosition","left",1,"ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text",3,"input","placeholder"],[1,"flex","align-items-center","gap-2"],["binary","true",3,"ngModelChange","ngModel","disabled"],["colspan","4"],[1,"flex","gap-2","align-items-center"],["colspan","2"]],template:function(t,o){if(t&1){let a=T();r(0,"div",4)(1,"div",5)(2,"p-button",6),f("onClick",function(){return y(a),I(o._back())}),n()(),r(3,"div",7)(4,"div",8)(5,"p-table",9,0),Z(7,Qe,7,3,"ng-template",10)(8,Ye,13,12,"ng-template",11)(9,Ze,11,6,"ng-template",12)(10,et,4,3,"ng-template",13),n()(),r(11,"div",8)(12,"p-table",14,1),Z(14,tt,7,3,"ng-template",10)(15,it,7,6,"ng-template",11)(16,ot,7,4,"ng-template",12)(17,rt,4,3,"ng-template",13),n()()(),r(18,"div",15)(19,"p-button",16),f("onClick",function(){return y(a),I(o.clear())}),n(),r(20,"p-button",17),f("onClick",function(){return y(a),I(o.save())}),n()()()}t&2&&(c(2),l("text",!0),c(3),l("value",o.merchantProducts)("globalFilterFields",U(10,Ke)),c(7),l("value",o.products)("paginator",!0)("rows",5)("tableStyle",U(11,Xe))("rowsPerPageOptions",U(12,qe)),c(7),l("disabled",!o.disabledProducts),c(),l("disabled",!o.disabledProducts))},dependencies:[C,Pe,H,ge,Ee,we,de,K,J,xe,Te,X,je,Ve,ze,Oe,ue,me,Ie,ye],encapsulation:2})}return i})();export{st as BrandsComponent,ct as CategoriesComponent,at as ClassificationsComponent,Mi as LinkProductsComponent,nt as MerchantproductsComponent,ti as ProductComponent,yt as ProductsCatalogComponent,pt as TagsComponent,dt as UnitsComponent,lt as VariantsComponent};
